<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    x:Class="Imdeliceapp.Popups.OrderItemStatusPopup"
    Size="360,420"
    CanBeDismissedByTappingOutsideOfPopup="False">
    <Border Stroke="{AppThemeBinding Light=#E5E5E5, Dark=#333333}"
            StrokeShape="{RoundRectangle CornerRadius=24}"
            BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1A1A1A}"
            Padding="20">
        <VerticalStackLayout Spacing="16">
            <Label Text="Cambiar estado del ítem"
                   FontSize="20"
                   FontAttributes="Bold"/>
            <Label Text="{Binding CurrentStatusDisplay}"
                   FontSize="13"
                   TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"/>

            <VerticalStackLayout Spacing="6">
                <Label Text="Nuevo estado"
                       FontAttributes="Bold"/>
                <Picker ItemsSource="{Binding StatusOptions}"
                        ItemDisplayBinding="{Binding Display}"
                        SelectedItem="{Binding SelectedStatus}"/>
            </VerticalStackLayout>

            <VerticalStackLayout Spacing="6">
                <Label Text="Motivo (opcional, se recomienda para cancelaciones)"
                       FontAttributes="Bold"
                       FontSize="13"/>
                <Editor Text="{Binding Reason}"
                        AutoSize="TextChanges"
                        Placeholder="Ej. Cliente cambió el orden"
                        HeightRequest="90"
                        BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#2C2C2C}"/>
            </VerticalStackLayout>

            <Label Text="{Binding ValidationMessage}"
                   TextColor="{AppThemeBinding Light=#D84315, Dark=#FFAB91}"
                   IsVisible="{Binding HasValidationMessage}"
                   FontSize="12"/>

            <HorizontalStackLayout Spacing="12">
                <Button Text="Cancelar"
                        Style="{StaticResource SecondaryPillButtonStyle}"
                        HorizontalOptions="FillAndExpand"
                        Clicked="Cancel_Clicked"/>
                <Button Text="Actualizar"
                        Style="{StaticResource PrimaryPillButtonStyle}"
                        HorizontalOptions="FillAndExpand"
                        Clicked="Save_Clicked"/>
            </HorizontalStackLayout>
        </VerticalStackLayout>
    </Border>
</toolkit:Popup>
