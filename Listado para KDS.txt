6. Listado para KDS
GET /api/orders/kds/listPermiso: orders.read
Query
	‚Ä¢	statuses: CSV, ej. NEW,READY
	‚Ä¢	El backend:
	‚Ä¢	lo pasa a may√∫sculas
	‚Ä¢	ignora estados inv√°lidos
Respuesta
Tarjetas KDS con:
	‚Ä¢	itemId
	‚Ä¢	orderId
	‚Ä¢	status
	‚Ä¢	quantity
	‚Ä¢	name
	‚Ä¢	variant
	‚Ä¢	tableName
	‚Ä¢	code
	‚Ä¢	serviceType
	‚Ä¢	parentItemId
entonces /api/orders/kds/list es la versi√≥n recortada para KDS: solo lo que la cocina necesita ver r√°pido, sin pagos, sin cliente de m√°s, sin totales complejos, y enfocada en √≠tems que todav√≠a no est√°n servidos.
Como tu ZIP no trae el nombre tal cual indexado, te lo armo siguiendo el mismo patr√≥n que ya traes en √≥rdenes (status, serviceType, source, items con modifiers, combos con hijos) para que lo puedas pegar.
Te dejo todos los casos posibles que tendr√≠a sentido que devuelva este endpoint en tu backend.

Endpoint

GET /api/orders/kds/list
permiso: orders.read   // o kds.read, pero en tu proyecto todo lo de orders est√° bajo orders.read
Query params t√≠picos (los mismos que usas en /api/orders, pero ‚Äúkitchenizados‚Äù)
	‚Ä¢	statuses ‚Üí CSV de estados de √≠tems/√≥rdenes que cocina quiere ver, ej: NEW,IN_PROGRESS
	‚Ä¢	serviceType ‚Üí DINE_IN | TAKEAWAY | DELIVERY
	‚Ä¢	source ‚Üí POS | UBER | DIDI | RAPPI
	‚Ä¢	from / to ‚Üí rango de fecha/hora de apertura
	‚Ä¢	(opcional) tableId ‚Üí para mostrar solo las mesas
La idea: la cocina pide esta lista cada X segundos y la pantalla se refresca.

Forma de la respuesta (propuesta coherente con tu API)
Responde con wrapper como siempre:

{
  "error": null,
  "data": [ /* tickets kds */ ],
  "message": "OK"
}
y cada ticket de KDS as√≠:

{
  "orderId": 71,
  "code": "A-2025-000071",
  "status": "OPEN",
  "serviceType": "DINE_IN",
  "source": "POS",
  "openedAt": "2025-10-30T17:32:00.000Z",
  "table": { "id": 2, "name": "M2" },
  "note": "Mesa de la entrada",
  "prepEtaMinutes": null,
  "customerName": null,
  "items": [
    {
      "id": 9001,
      "productId": 12,
      "name": "Torta ahogada",
      "variantName": null,
      "quantity": 2,
      "status": "NEW",              // para cocina
      "notes": "Poquita salsa",
      "modifiers": [
        { "name": "Sin cebolla", "quantity": 1 }
      ],
      "isComboParent": false,
      "children": []
    }
  ]
}
F√≠jate que:
	‚Ä¢	no mando pagos
	‚Ä¢	no mando totales en centavos (cocina no los necesita)
	‚Ä¢	s√≠ mando items ya ‚Äútraducidos‚Äù (con nombreSnapshot)

CASOS üß™
1. DINE_IN sencillo, 1 item

{
  "error": null,
  "data": [
    {
      "orderId": 71,
      "code": "A-2025-000071",
      "status": "OPEN",
      "serviceType": "DINE_IN",
      "source": "POS",
      "openedAt": "2025-10-30T17:32:00.000Z",
      "table": { "id": 2, "name": "M2" },
      "note": "Mesa de la entrada",
      "prepEtaMinutes": null,
      "customerName": null,
      "items": [
        {
          "id": 9001,
          "productId": 12,
          "name": "Torta ahogada",
          "variantName": null,
          "quantity": 2,
          "status": "NEW",
          "notes": "Poquita salsa",
          "modifiers": [],
          "isComboParent": false,
          "children": []
        }
      ]
    }
  ],
    "message": "OK"
}
üëâ √ösalo para la pantalla principal de cocina.

2. DELIVERY (no mesa) con variante y modifier

{
  "error": null,
  "data": [
    {
      "orderId": 88,
      "code": "DLV-2025-000088",
      "status": "OPEN",
      "serviceType": "DELIVERY",
      "source": "UBER",
      "openedAt": "2025-10-30T17:40:00.000Z",
      "table": null,
      "note": "Dejar en recepci√≥n",
      "prepEtaMinutes": 25,
      "customerName": "Carlos Pacheco",
      "items": [
        {
          "id": 9100,
          "productId": 40,
          "name": "Ensalada C√©sar",
          "variantName": "Grande",
          "quantity": 1,
          "status": "NEW",
          "notes": "Aderezo aparte",
          "modifiers": [
            { "name": "Aderezo extra", "quantity": 1 }
          ],
          "isComboParent": false,
          "children": []
        }
      ]
    }
  ],
  "message": "OK"
}
üëâ Aqu√≠ cocina ve: es delivery, es Uber, cliente, nota, y qu√© preparar.

3. Pedido con COMBO (pap√° + hijos)
Este es el que m√°s confunde al front, as√≠ que as√≠ debe verse en KDS:

{
  "error": null,
  "data": [
    {
      "orderId": 90,
      "code": "A-2025-000090",
      "status": "OPEN",
      "serviceType": "DINE_IN",
      "source": "POS",
      "openedAt": "2025-10-30T17:45:00.000Z",
      "table": { "id": 4, "name": "M4" },
      "note": null,
      "prepEtaMinutes": null,
      "customerName": null,
      "items": [
        {
          "id": 9200,
          "productId": 30,
          "name": "Combo burger + papas",
          "variantName": null,
          "quantity": 1,
          "status": "NEW",
          "notes": null,
          "modifiers": [],
          "isComboParent": true,
          "children": [
            {
              "id": 9201,
              "name": "Hamburguesa sencilla",
              "quantity": 1,
              "status": "NEW",
              "notes": null,
              "modifiers": []
            },
            {
              "id": 9202,
              "name": "Papas fritas",
              "quantity": 1,
              "status": "NEW",
              "notes": null,
              "modifiers": []
            }
          ]
        }
      ]
    }
  ],
  "message": "OK"
}
üëâ Nota: en tu repo los childItems ven√≠an sin product, por eso en KDS conviene mandarlos ya ‚Äúplanchados‚Äù con name.

4. Pedido con 2 √≠tems en distintos estados (NEW y IN_PROGRESS)
Esto es t√≠pico de KDS:

{
  "error": null,
  "data": [
    {
      "orderId": 91,
      "code": "A-2025-000091",
      "status": "OPEN",
      "serviceType": "DINE_IN",
      "source": "POS",
      "openedAt": "2025-10-30T17:55:00.000Z",
      "table": { "id": 7, "name": "M7" },
      "items": [
        {
          "id": 9300,
          "productId": 18,
          "name": "Chilaquiles rojos",
          "variantName": null,
          "quantity": 1,
          "status": "IN_PROGRESS",
          "notes": "Extra pollo",
          "modifiers": [
            { "name": "Pollo extra", "quantity": 1 }
          ],
          "isComboParent": false,
          "children": []
        },
        {
          "id": 9301,
          "productId": 51,
          "name": "Limonada",
          "variantName": null,
          "quantity": 1,
          "status": "NEW",
          "notes": null,
          "modifiers": [],
          "isComboParent": false,
          "children": []
        }
      ]
    }
  ],
  "message": "OK"
}
üëâ As√≠ el front puede pintar columnas por estado.

5. Filtro por estado
Request

GET /api/orders/kds/list?statuses=NEW,IN_PROGRESS
Response

{
  "error": null,
  "data": [
    { "orderId": 71, "...": "..." },
    { "orderId": 90, "...": "..." }
  ],
  "message": "OK"
}
üëâ Cocina no ve los que ya est√°n READY/SERVED.

6. Filtro por tipo de servicio (solo delivery)
Request

GET /api/orders/kds/list?serviceType=DELIVERY
Response

{
  "error": null,
  "data": [
    {
      "orderId": 88,
      "code": "DLV-2025-000088",
      "serviceType": "DELIVERY",
      "source": "UBER",
      "items": [ /* ... */ ]
    }
  ],
  "message": "OK"
}

7. Pedido ya listo (READY) que igual se muestra
Si tu KDS muestra los que ya est√°n listos para que el mesero los recoja:

{
  "error": null,
  "data": [
    {
      "orderId": 95,
      "code": "A-2025-000095",
      "status": "OPEN",
      "serviceType": "DINE_IN",
      "source": "POS",
      "openedAt": "2025-10-30T18:05:00.000Z",
      "table": { "id": 9, "name": "Terraza" },
      "items": [
        {
          "id": 9400,
          "name": "Molletes",
          "quantity": 1,
          "status": "READY",
          "notes": null,
          "modifiers": [],
          "isComboParent": false,
          "children": []
        }
      ]
    }
  ],
  "message": "OK"
}

8. Pedido con nota general + nota en √≠tem

{
  "error": null,
  "data": [
    {
      "orderId": 99,
      "code": "A-2025-000099",
      "status": "OPEN",
      "serviceType": "DINE_IN",
      "table": { "id": 10, "name": "M10" },
      "note": "Alergia a mariscos",         // nota del pedido
      "items": [
        {
          "id": 9500,
          "name": "Pasta Alfredo",
          "quantity": 1,
          "status": "NEW",
          "notes": "Sin camar√≥n",           // nota del √≠tem
          "modifiers": [],
          "isComboParent": false,
          "children": []
        }
      ]
    }
  ],
  "message": "OK"
}
üëâ Esto es importante que lo pintes doble en cocina.

9. Sin resultados (filtro muy cerrado)

{
  "error": null,
  "data": [],
  "message": "OK"
}
üëâ El front tiene que mostrar ‚Äúno hay tickets‚Äù.


10. Notas funcionales clave
	‚Ä¢	Los totales siempre se recalculan ignorando √≠tems cancelados.
	‚Ä¢	Se respetan descuentos / impuestos / service fee ya guardados.
	‚Ä¢	prepEtaMinutes sirve para mostrar ETA en front / kiosko.
	‚Ä¢	source y externalRef diferencian interno vs plataforma.
	‚Ä¢	Con esto el front puede hacer todo el flujo:
	0.	creaci√≥n
	0.	agregar / editar √≠tems
	0.	KDS
	0.	cobros
	0.	cierre
	0.	listado con filtros

11. Glosario para el front
Permisos
	‚Ä¢	orders.read: puede listar y ver
	‚Ä¢	orders.create: puede crear
	‚Ä¢	orders.update: puede editar, pagar, mover estado
serviceType (tipo de servicio)
	‚Ä¢	DINE_IN: consumo en mesa
	‚Ä¢	TAKEAWAY: para llevar
	‚Ä¢	DELIVERY: a domicilio
source (canal)
	‚Ä¢	POS: pedido directo
	‚Ä¢	UBER, DIDI, RAPPI: plataformas externas
status del pedido
	‚Ä¢	DRAFT: borrador, no cocina
	‚Ä¢	OPEN: activo
	‚Ä¢	HOLD: en pausa
	‚Ä¢	CLOSED: cobrado y cerrado
	‚Ä¢	CANCELED: cancelado
OrderItem.status
	‚Ä¢	NEW
	‚Ä¢	IN_PROGRESS
	‚Ä¢	READY
	‚Ä¢	SERVED
	‚Ä¢	CANCELED
Timestamps
	‚Ä¢	acceptedAt: el pedido sali√≥ de borrador / cocina lo tom√≥
	‚Ä¢	readyAt: todos los √≠tems est√°n listos
	‚Ä¢	servedAt: todos servidos o cancelados
	‚Ä¢	closedAt: se cobr√≥
	‚Ä¢	canceledAt: se cancel√≥
Totales (centavos)
	‚Ä¢	subtotalCents: suma de renglones
	‚Ä¢	discountCents: descuentos
	‚Ä¢	serviceFeeCents: propina/fee fijo
	‚Ä¢	taxCents: impuestos
	‚Ä¢	totalCents: subtotal - descuento + service + tax
	‚Ä¢	paymentsTotalCents: suma de pagos
	‚Ä¢	paymentsTipCents: suma de propinas
Pagos (payments[])
	‚Ä¢	method: CASH | CARD | TRANSFER | OTHER
	‚Ä¢	amountCents
	‚Ä¢	tipCents
	‚Ä¢	paidAt
	‚Ä¢	note
Mesa
	‚Ä¢	tableId: id de la mesa
	‚Ä¢	table: { id, name } para mostrar ‚ÄúMesa 12‚Äù
	‚Ä¢	covers: n√∫mero de comensales
DTOs clave
	‚Ä¢	ListOrdersQueryDto: filtros del GET
	‚Ä¢	UpdateOrderMetaDto: para editar nota, mesa, cubiertos, ETA
	‚Ä¢	UpdateOrderStatusDto: para mover el pedido validando pagos
