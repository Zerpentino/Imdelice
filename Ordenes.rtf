{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 HelveticaNeue;\f1\fnil\fcharset0 HelveticaNeue-Bold;\f2\fnil\fcharset0 Menlo-Regular;
\f3\froman\fcharset0 Times-Roman;\f4\froman\fcharset0 Times-Bold;\f5\fmodern\fcharset0 Courier;
\f6\fmodern\fcharset0 Courier-Bold;\f7\froman\fcharset0 Times-BoldItalic;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red109\green109\blue109;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c50196\c50196\c50196;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid202\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid10}
{\list\listtemplateid11\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid11}
{\list\listtemplateid12\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid12}
{\list\listtemplateid13\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid13}
{\list\listtemplateid14\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid14}
{\list\listtemplateid15\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid15}
{\list\listtemplateid16\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid16}
{\list\listtemplateid17\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid17}
{\list\listtemplateid18\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid1702\'02\'01.;}{\levelnumbers\'01;}\fi-360\li1440\lin1440 }{\listname ;}\listid18}
{\list\listtemplateid19\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid19}
{\list\listtemplateid20\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid1901\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid20}
{\list\listtemplateid21\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid2001\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid21}
{\list\listtemplateid22\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid2101\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid22}
{\list\listtemplateid23\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid2201\'02\'00.;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid23}
{\list\listtemplateid24\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2302\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid24}
{\list\listtemplateid25\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid25}
{\list\listtemplateid26\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid26}
{\list\listtemplateid27\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid27}
{\list\listtemplateid28\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid28}
{\list\listtemplateid29\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid29}
{\list\listtemplateid30\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid2901\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid30}
{\list\listtemplateid31\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid31}
{\list\listtemplateid32\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid3101\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid3102\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid32}
{\list\listtemplateid33\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid33}
{\list\listtemplateid34\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid34}
{\list\listtemplateid35\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid3401\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid35}
{\list\listtemplateid36\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid36}
{\list\listtemplateid37\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid37}
{\list\listtemplateid38\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid3701\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid38}
{\list\listtemplateid39\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid39}
{\list\listtemplateid40\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid40}
{\list\listtemplateid41\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid41}
{\list\listtemplateid42\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid42}
{\list\listtemplateid43\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid43}
{\list\listtemplateid44\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid44}
{\list\listtemplateid45\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid45}
{\list\listtemplateid46\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid4501\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid4502\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid46}
{\list\listtemplateid47\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid47}
{\list\listtemplateid48\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid48}
{\list\listtemplateid49\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid49}
{\list\listtemplateid50\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid4901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid50}
{\list\listtemplateid51\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid51}
{\list\listtemplateid52\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid52}
{\list\listtemplateid53\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid53}
{\list\listtemplateid54\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid5301\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid5302\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid54}
{\list\listtemplateid55\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid55}
{\list\listtemplateid56\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid56}
{\list\listtemplateid57\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid5602\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid57}
{\list\listtemplateid58\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid58}
{\list\listtemplateid59\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid59}
{\list\listtemplateid60\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid5901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid60}
{\list\listtemplateid61\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid61}
{\list\listtemplateid62\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid62}
{\list\listtemplateid63\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid63}
{\list\listtemplateid64\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid6302\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid64}
{\list\listtemplateid65\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid65}
{\list\listtemplateid66\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid66}
{\list\listtemplateid67\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid6601\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid6602\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid67}
{\list\listtemplateid68\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid68}
{\list\listtemplateid69\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid69}
{\list\listtemplateid70\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid6901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid70}
{\list\listtemplateid71\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid71}
{\list\listtemplateid72\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid72}
{\list\listtemplateid73\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid7201\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid73}
{\list\listtemplateid74\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7302\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid74}
{\list\listtemplateid75\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid7401\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid75}
{\list\listtemplateid76\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid76}
{\list\listtemplateid77\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid7601\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid7602\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid77}
{\list\listtemplateid78\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid7702\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid78}
{\list\listtemplateid79\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid79}
{\list\listtemplateid80\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid7901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid80}
{\list\listtemplateid81\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid8001\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid81}
{\list\listtemplateid82\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid8101\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid82}
{\list\listtemplateid83\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}.}{\leveltext\leveltemplateid8202\'02\'01.;}{\levelnumbers\'01;}\fi-360\li1440\lin1440 }{\listname ;}\listid83}
{\list\listtemplateid84\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid84}
{\list\listtemplateid85\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid85}
{\list\listtemplateid86\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid86}
{\list\listtemplateid87\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid87}
{\list\listtemplateid88\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid88}
{\list\listtemplateid89\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid89}
{\list\listtemplateid90\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid8901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid90}
{\list\listtemplateid91\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid9001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid91}
{\list\listtemplateid92\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid9101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid92}
{\list\listtemplateid93\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid9201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid93}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}{\listoverride\listid11\listoverridecount0\ls11}{\listoverride\listid12\listoverridecount0\ls12}{\listoverride\listid13\listoverridecount0\ls13}{\listoverride\listid14\listoverridecount0\ls14}{\listoverride\listid15\listoverridecount0\ls15}{\listoverride\listid16\listoverridecount0\ls16}{\listoverride\listid17\listoverridecount0\ls17}{\listoverride\listid18\listoverridecount0\ls18}{\listoverride\listid19\listoverridecount0\ls19}{\listoverride\listid20\listoverridecount0\ls20}{\listoverride\listid21\listoverridecount0\ls21}{\listoverride\listid22\listoverridecount0\ls22}{\listoverride\listid23\listoverridecount0\ls23}{\listoverride\listid24\listoverridecount0\ls24}{\listoverride\listid25\listoverridecount0\ls25}{\listoverride\listid26\listoverridecount0\ls26}{\listoverride\listid27\listoverridecount0\ls27}{\listoverride\listid28\listoverridecount0\ls28}{\listoverride\listid29\listoverridecount0\ls29}{\listoverride\listid30\listoverridecount0\ls30}{\listoverride\listid31\listoverridecount0\ls31}{\listoverride\listid32\listoverridecount0\ls32}{\listoverride\listid33\listoverridecount0\ls33}{\listoverride\listid34\listoverridecount0\ls34}{\listoverride\listid35\listoverridecount0\ls35}{\listoverride\listid36\listoverridecount0\ls36}{\listoverride\listid37\listoverridecount0\ls37}{\listoverride\listid38\listoverridecount0\ls38}{\listoverride\listid39\listoverridecount0\ls39}{\listoverride\listid40\listoverridecount0\ls40}{\listoverride\listid41\listoverridecount0\ls41}{\listoverride\listid42\listoverridecount0\ls42}{\listoverride\listid43\listoverridecount0\ls43}{\listoverride\listid44\listoverridecount0\ls44}{\listoverride\listid45\listoverridecount0\ls45}{\listoverride\listid46\listoverridecount0\ls46}{\listoverride\listid47\listoverridecount0\ls47}{\listoverride\listid48\listoverridecount0\ls48}{\listoverride\listid49\listoverridecount0\ls49}{\listoverride\listid50\listoverridecount0\ls50}{\listoverride\listid51\listoverridecount0\ls51}{\listoverride\listid52\listoverridecount0\ls52}{\listoverride\listid53\listoverridecount0\ls53}{\listoverride\listid54\listoverridecount0\ls54}{\listoverride\listid55\listoverridecount0\ls55}{\listoverride\listid56\listoverridecount0\ls56}{\listoverride\listid57\listoverridecount0\ls57}{\listoverride\listid58\listoverridecount0\ls58}{\listoverride\listid59\listoverridecount0\ls59}{\listoverride\listid60\listoverridecount0\ls60}{\listoverride\listid61\listoverridecount0\ls61}{\listoverride\listid62\listoverridecount0\ls62}{\listoverride\listid63\listoverridecount0\ls63}{\listoverride\listid64\listoverridecount0\ls64}{\listoverride\listid65\listoverridecount0\ls65}{\listoverride\listid66\listoverridecount0\ls66}{\listoverride\listid67\listoverridecount0\ls67}{\listoverride\listid68\listoverridecount0\ls68}{\listoverride\listid69\listoverridecount0\ls69}{\listoverride\listid70\listoverridecount0\ls70}{\listoverride\listid71\listoverridecount0\ls71}{\listoverride\listid72\listoverridecount0\ls72}{\listoverride\listid73\listoverridecount0\ls73}{\listoverride\listid74\listoverridecount0\ls74}{\listoverride\listid75\listoverridecount0\ls75}{\listoverride\listid76\listoverridecount0\ls76}{\listoverride\listid77\listoverridecount0\ls77}{\listoverride\listid78\listoverridecount0\ls78}{\listoverride\listid79\listoverridecount0\ls79}{\listoverride\listid80\listoverridecount0\ls80}{\listoverride\listid81\listoverridecount0\ls81}{\listoverride\listid82\listoverridecount0\ls82}{\listoverride\listid83\listoverridecount0\ls83}{\listoverride\listid84\listoverridecount0\ls84}{\listoverride\listid85\listoverridecount0\ls85}{\listoverride\listid86\listoverridecount0\ls86}{\listoverride\listid87\listoverridecount0\ls87}{\listoverride\listid88\listoverridecount0\ls88}{\listoverride\listid89\listoverridecount0\ls89}{\listoverride\listid90\listoverridecount0\ls90}{\listoverride\listid91\listoverridecount0\ls91}{\listoverride\listid92\listoverridecount0\ls92}{\listoverride\listid93\listoverridecount0\ls93}}
\margl1440\margr1440\vieww37900\viewh18400\viewkind0
\deftab560
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Contrato del m\'f3dulo de pedidos (API)\
0. Notas generales\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls1\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Todas las respuestas usan 
\f1\b wrapper est\'e1ndar
\f0\b0 :\uc0\u8232 \{ error, data, message \}\
\ls1\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Todas las rutas est\'e1n protegidas con permisos:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls1\ilvl1
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 orders.read\
\ls1\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 orders.create\
\ls1\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 orders.update\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls1\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 El controlador usa AuthRequest, asyncHandler y 
\f1\b no
\f0\b0  usa console.log.\
\ls1\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Siempre que se toca un pedido se 
\f1\b recalculan totales
\f0\b0  ignorando \'edtems cancelados.\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1. Listar pedidos\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 GET
\f0\b0  /api/orders\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.read\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Query params (todos opcionales)\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls2\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 statuses: CSV de estados, ej. OPEN,HOLD\
\ls2\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 serviceType: DINE_IN | TAKEAWAY | DELIVERY\
\ls2\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 source: POS | UBER | DIDI | RAPPI\
\ls2\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 from / to: fechas ISO; to se expande al final del d\'eda\
\ls2\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 tableId: entero\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Respuesta (data[])\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 Para cada pedido:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls3\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 id\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 code\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 status: DRAFT | OPEN | HOLD | CLOSED | CANCELED\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 serviceType: sala / llevar / delivery\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 source: canal (POS, UBER, etc.)\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f1\b\fs26 Montos (en centavos):
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls3\ilvl1
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 subtotalCents\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 discountCents\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 serviceFeeCents\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 taxCents\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 totalCents\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 paymentsTotalCents\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 paymentsTipCents\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls3\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f1\b\fs26 Timestamps clave:
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls3\ilvl1
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 openedAt\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 acceptedAt\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 readyAt\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 servedAt\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 closedAt\
\ls3\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 canceledAt\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls3\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 prepEtaMinutes (nullable)\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 externalRef\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 table: \{ id, name \} si hay mesa\
\ls3\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 payments[]: id, method, amountCents, tipCents, paidAt, note\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Esta l\'f3gica est\'e1 en PrismaOrderRepository.list + OrdersController.list.\
Ejemplo\
\{\
    "error": null,\
    "data": [\
        \{\
            "id": 2,\
            "code": "IM-251030-H8AX",\
            "status": "OPEN",\
            "serviceType": "DELIVERY",\
            "source": "POS",\
            "subtotalCents": 0,\
            "discountCents": 0,\
            "serviceFeeCents": 0,\
            "taxCents": 0,\
            "totalCents": 0,\
            "paymentsTotalCents": 0,\
            "paymentsTipCents": 0,\
            "openedAt": "2025-10-30T17:12:45.060Z",\
            "closedAt": null,\
            "acceptedAt": "2025-10-30T17:12:45.059Z",\
            "readyAt": null,\
            "servedAt": null,\
            "canceledAt": null,\
            "prepEtaMinutes": 18,\
            "externalRef": "UBER-ORD-99321",\
            "table": \{\
                "id": 1,\
                "name": "Mesa 1 (actualizada)"\
            \},\
            "payments": []\
        \},\
        \{\
            "id": 1,\
            "code": "IM-251030-LR97",\
            "status": "OPEN",\
            "serviceType": "DINE_IN",\
            "source": "POS",\
            "subtotalCents": 0,\
            "discountCents": 0,\
            "serviceFeeCents": 0,\
            "taxCents": 0,\
            "totalCents": 0,\
            "paymentsTotalCents": 0,\
            "paymentsTipCents": 0,\
            "openedAt": "2025-10-30T17:08:53.722Z",\
            "closedAt": null,\
            "acceptedAt": "2025-10-30T17:08:53.719Z",\
            "readyAt": null,\
            "servedAt": null,\
            "canceledAt": null,\
            "prepEtaMinutes": 18,\
            "externalRef": "UBER-ORD-99321",\
            "table": \{\
                "id": 1,\
                "name": "Mesa 1 (actualizada)"\
            \},\
            "payments": []\
        \}\
    ],\
    "message": "OK"\
\}\
Estructura que sale del repo (ya la vi): cada pedido trae m\'e1s o menos esto:\
\
\{\
  "id": 45,\
  "code": "A-2025-000045",\
  "status": "OPEN",\
  "serviceType": "DINE_IN",\
  "source": "POS",\
  "subtotalCents": 13000,\
  "discountCents": 0,\
  "serviceFeeCents": 0,\
  "taxCents": 0,\
  "totalCents": 13000,\
  "paymentsTotalCents": 0,\
  "paymentsTipCents": 0,\
  "openedAt": "2025-10-30T17:05:14.000Z",\
  "closedAt": null,\
  "acceptedAt": null,\
  "readyAt": null,\
  "servedAt": null,\
  "canceledAt": null,\
  "prepEtaMinutes": null,\
  "externalRef": null,\
  "table": \{ "id": 3, "name": "M3" \},\
  "payments": [\
    \{\
      "id": 1,\
      "method": "CASH",\
      "amountCents": 13000,\
      "tipCents": 0,\
      "paidAt": "2025-10-30T17:10:00.000Z",\
      "note": null\
    \}\
  ]\
\}\
Ojo: 
\f1\b en este listado NO vienen los items[]
\f0\b0 . Para eso es el GET /api/orders/:id.\
Te dejo los 
\f1\b casos completos
\f0\b0  para que el front no se pierda \uc0\u55357 \u56391 \
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 1 \'96 sin filtros (lista general)\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 Request
\f0\b0 \
\
GET \{\{baseUrl\}\}/api/orders\
Authorization: Bearer \{\{token\}\}\

\f1\b Response
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{\
      "id": 71,\
      "code": "A-2025-000071",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "subtotalCents": 18500,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 18500,\
      "paymentsTotalCents": 0,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T17:32:00.000Z",\
      "closedAt": null,\
      "acceptedAt": null,\
      "readyAt": null,\
      "servedAt": null,\
      "canceledAt": null,\
      "prepEtaMinutes": null,\
      "externalRef": null,\
      "table": \{ "id": 2, "name": "M2" \},\
      "payments": []\
    \},\
    \{\
      "id": 70,\
      "code": "A-2025-000070",\
      "status": "CLOSED",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "subtotalCents": 23000,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 23000,\
      "paymentsTotalCents": 23000,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T16:55:00.000Z",\
      "closedAt": "2025-10-30T17:25:00.000Z",\
      "acceptedAt": "2025-10-30T17:00:00.000Z",\
      "readyAt": "2025-10-30T17:10:00.000Z",\
      "servedAt": "2025-10-30T17:15:00.000Z",\
      "canceledAt": null,\
      "prepEtaMinutes": null,\
      "externalRef": null,\
      "table": \{ "id": 4, "name": "M4" \},\
      "payments": [\
        \{\
          "id": 10,\
          "method": "CASH",\
          "amountCents": 20000,\
          "tipCents": 0,\
          "paidAt": "2025-10-30T17:23:00.000Z",\
          "note": null\
        \},\
        \{\
          "id": 11,\
          "method": "CARD",\
          "amountCents": 3000,\
          "tipCents": 0,\
          "paidAt": "2025-10-30T17:24:00.000Z",\
          "note": "Resto en tarjeta"\
        \}\
      ]\
    \},\
    \{\
      "id": 61,\
      "code": "DLV-2025-000061",\
      "status": "OPEN",\
      "serviceType": "DELIVERY",\
      "source": "UBER",\
      "subtotalCents": 8500,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 8500,\
      "paymentsTotalCents": 0,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T17:20:00.000Z",\
      "closedAt": null,\
      "acceptedAt": null,\
      "readyAt": null,\
      "servedAt": null,\
      "canceledAt": null,\
      "prepEtaMinutes": 25,\
      "externalRef": "UBER#12345",\
      "table": null,\
      "payments": []\
    \}\
  ],\
  "message": "OK"\
\}\
Qu\'e9 ve el front:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls4\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 mezcla de 
\f1\b DINE_IN
\f0\b0  y 
\f1\b DELIVERY
\f0\b0 \
\ls4\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 algunos tienen mesa, otros no\
\ls4\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 algunos ya tienen pagos\
\ls4\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 vienen ordenados por openedAt desc\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 2 \'96 filtrar por estado\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 El DTO acepta statuses como CSV.\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Request
\f0\b0 \
\
GET \{\{baseUrl\}\}/api/orders?statuses=OPEN,HOLD\
Authorization: Bearer \{\{token\}\}\

\f1\b Response (ejemplo)
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{\
      "id": 71,\
      "code": "A-2025-000071",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "subtotalCents": 18500,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 18500,\
      "paymentsTotalCents": 0,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T17:32:00.000Z",\
      "closedAt": null,\
      "table": \{ "id": 2, "name": "M2" \},\
      "payments": []\
    \},\
    \{\
      "id": 61,\
      "code": "DLV-2025-000061",\
      "status": "OPEN",\
      "serviceType": "DELIVERY",\
      "source": "UBER",\
      "subtotalCents": 8500,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 8500,\
      "paymentsTotalCents": 0,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T17:20:00.000Z",\
      "closedAt": null,\
      "table": null,\
      "payments": []\
    \}\
  ],\
  "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 3 \'96 solo los de restaurante (DINE_IN)\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 Request
\f0\b0 \
\
GET \{\{baseUrl\}\}/api/orders?serviceType=DINE_IN\

\f1\b Response
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{\
      "id": 71,\
      "code": "A-2025-000071",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "subtotalCents": 18500,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 18500,\
      "paymentsTotalCents": 0,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T17:32:00.000Z",\
      "closedAt": null,\
      "table": \{ "id": 2, "name": "M2" \},\
      "payments": []\
    \},\
    \{\
      "id": 70,\
      "code": "A-2025-000070",\
      "status": "CLOSED",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "subtotalCents": 23000,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 23000,\
      "paymentsTotalCents": 23000,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T16:55:00.000Z",\
      "closedAt": "2025-10-30T17:25:00.000Z",\
      "table": \{ "id": 4, "name": "M4" \},\
      "payments": [\
        \{ "id": 10, "method": "CASH", "amountCents": 20000, "tipCents": 0, "paidAt": "2025-10-30T17:23:00.000Z", "note": null \},\
        \{ "id": 11, "method": "CARD", "amountCents": 3000, "tipCents": 0, "paidAt": "2025-10-30T17:24:00.000Z", "note": "Resto en tarjeta" \}\
      ]\
    \}\
  ],\
  "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 4 \'96 solo los de una mesa\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 El controller hace tableId num\'e9rico.\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Request
\f0\b0 \
\
GET \{\{baseUrl\}\}/api/orders?tableId=2&statuses=OPEN\

\f1\b Response
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{\
      "id": 71,\
      "code": "A-2025-000071",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "subtotalCents": 18500,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 18500,\
      "paymentsTotalCents": 0,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T17:32:00.000Z",\
      "closedAt": null,\
      "table": \{ "id": 2, "name": "M2" \},\
      "payments": []\
    \}\
  ],\
  "message": "OK"\
\}\
Esto le sirve al front para \'93ver qu\'e9 tiene la mesa 2\'94.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 5 \'96 por origen (source=UBER, DIDI, RAPPI\'85)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 El DTO transforma array a \'93primer valor\'94, as\'ed que con uno basta.\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Request
\f0\b0 \
\
GET \{\{baseUrl\}\}/api/orders?source=UBER\

\f1\b Response
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{\
      "id": 61,\
      "code": "DLV-2025-000061",\
      "status": "OPEN",\
      "serviceType": "DELIVERY",\
      "source": "UBER",\
      "subtotalCents": 8500,\
      "discountCents": 0,\
      "serviceFeeCents": 0,\
      "taxCents": 0,\
      "totalCents": 8500,\
      "paymentsTotalCents": 0,\
      "paymentsTipCents": 0,\
      "openedAt": "2025-10-30T17:20:00.000Z",\
      "closedAt": null,\
      "table": null,\
      "payments": []\
    \}\
  ],\
  "message": "OK"\
\}\
\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 7 \'96 por fecha (from / to)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 El controller hace:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls5\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 from \uc0\u8594  openedAt >= from\
\ls5\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 to \uc0\u8594  openedAt <= to (fin de d\'eda)\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Request
\f0\b0 \
\
GET \{\{baseUrl\}\}/api/orders?from=2025-10-30&to=2025-10-30\

\f1\b Response (resumen)
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{ "id": 71, "code": "A-2025-000071", "status": "OPEN", "serviceType": "DINE_IN", "source": "POS", "subtotalCents": 18500, "totalCents": 18500, "openedAt": "2025-10-30T17:32:00.000Z", "table": \{ "id": 2, "name": "M2" \}, "payments": [] \},\
    \{ "id": 70, "code": "A-2025-000070", "status": "CLOSED", "serviceType": "DINE_IN", "source": "POS", "subtotalCents": 23000, "totalCents": 23000, "openedAt": "2025-10-30T16:55:00.000Z", "table": \{ "id": 4, "name": "M4" \}, "payments": [ /* ... */ ] \},\
    \{ "id": 61, "code": "DLV-2025-000061", "status": "OPEN", "serviceType": "DELIVERY", "source": "UBER", "subtotalCents": 8500, "totalCents": 8500, "openedAt": "2025-10-30T17:20:00.000Z", "table": null, "payments": [] \}\
  ],\
  "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 2. Obtener un pedido\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 GET
\f0\b0  /api/orders/:id\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.read\
Devuelve 
\f1\b el ticket completo
\f0\b0 :\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls6\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 datos del pedido\
\ls6\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 \'edtems (producto, variante, modifiers, combos hijos)\
\ls6\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 pagos\
\ls6\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 mesa\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Ejemplos casos:\uc0\u8232 \{\
    "error": null,\
    "data": \{\
        "id": 2,\
        "code": "IM-251030-H8AX",\
        "status": "OPEN",\
        "serviceType": "DELIVERY",\
        "source": "POS",\
        "externalRef": "UBER-ORD-99321",\
        "prepEtaMinutes": 18,\
        "tableId": 1,\
        "openedAt": "2025-10-30T17:12:45.060Z",\
        "acceptedAt": "2025-10-30T17:12:45.059Z",\
        "readyAt": null,\
        "servedAt": null,\
        "closedAt": null,\
        "canceledAt": null,\
        "note": "Sin jitomate en la baguette",\
        "customerName": null,\
        "customerPhone": null,\
        "covers": 3,\
        "servedByUserId": 1,\
        "subtotalCents": 15400,\
        "discountCents": 0,\
        "serviceFeeCents": 0,\
        "taxCents": 0,\
        "totalCents": 15400,\
        "items": [\
            \{\
                "id": 1,\
                "orderId": 2,\
                "productId": 18,\
                "variantId": null,\
                "parentItemId": null,\
                "quantity": 2,\
                "status": "NEW",\
                "basePriceCents": 7700,\
                "extrasTotalCents": 0,\
                "totalPriceCents": 15400,\
                "nameSnapshot": "Marquesita Champi",\
                "variantNameSnapshot": null,\
                "notes": "Mesa 4, lo quiere r\'e1pido",\
                "variant": null,\
                "product": \{\
                    "id": 18,\
                    "name": "Marquesita Champi",\
                    "type": "SIMPLE"\
                \},\
                "modifiers": [\
                    \{\
                        "id": 1,\
                        "orderItemId": 1,\
                        "optionId": 5,\
                        "quantity": 1,\
                        "priceExtraCents": 0,\
                        "nameSnapshot": "Pi\'f1a"\
                    \},\
                    \{\
                        "id": 2,\
                        "orderItemId": 1,\
                        "optionId": 8,\
                        "quantity": 1,\
                        "priceExtraCents": 0,\
                        "nameSnapshot": "Salsa de Pizza"\
                    \}\
                ],\
                "childItems": [],\
                "parentItem": null\
            \}\
        ],\
        "payments": [],\
        "table": \{\
            "id": 1,\
            "name": "Mesa 1 (actualizada)",\
            "seats": 6,\
            "isActive": false\
        \}\
    \},\
    "message": "OK"\
\}\
\uc0\u8232 \u8232 
\f1\b\fs32 Caso 1: pedido sencillo en mesa (DINE_IN), abierto, sin pagos\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 Request
\f0\b0 \
\
GET http://localhost:3000/api/orders/45\
Authorization: Bearer \{\{token\}\}\

\f1\b Response
\f0\b0 \
\
\{\
  "error": null,\
  "data": \{\
    "id": 45,\
    "code": "A-2025-000045",\
    "status": "OPEN",\
    "serviceType": "DINE_IN",\
    "source": "POS",\
    "tableId": 3,\
    "table": \{\
      "id": 3,\
      "name": "M3",\
      "seats": 4,\
      "isActive": true\
    \},\
    "openedAt": "2025-10-30T17:05:14.000Z",\
    "acceptedAt": null,\
    "readyAt": null,\
    "servedAt": null,\
    "closedAt": null,\
    "canceledAt": null,\
    "note": "Mesa de la entrada",\
    "customerName": null,\
    "customerPhone": null,\
    "covers": 2,\
    "subtotalCents": 13000,\
    "discountCents": 0,\
    "serviceFeeCents": 0,\
    "taxCents": 0,\
    "totalCents": 13000,\
    "items": [\
      \{\
        "id": 101,\
        "orderId": 45,\
        "productId": 12,\
        "product": \{\
          "id": 12,\
          "name": "Torta ahogada",\
          "type": "SIMPLE"\
        \},\
        "variantId": null,\
        "variant": null,\
        "parentItemId": null,\
        "parentItem": null,\
        "childItems": [],\
        "quantity": 2,\
        "status": "NEW",\
        "basePriceCents": 6500,\
        "extrasTotalCents": 0,\
        "totalPriceCents": 13000,\
        "nameSnapshot": "Torta ahogada",\
        "variantNameSnapshot": null,\
        "notes": "Con poquita salsa",\
        "modifiers": []\
      \}\
    ],\
    "payments": []\
  \},\
  "message": "OK"\
\}\

\f1\b Qu\'e9 aprende el front aqu\'ed:
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls7\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Si hay mesa \uc0\u8594  viene table completo.\
\ls7\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Si no hay pagos \uc0\u8594  payments: [].\
\ls7\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Los montos vienen en 
\f1\b centavos
\f0\b0 .\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 2: pedido con combo (tiene hijos dentro de 
\fs40 items
\fs32 )\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 Aqu\'ed se ve lo que te pusieron: \'93\'edtems (producto, variante, 
\f1\b modifiers, combos hijos
\f0\b0 )\'94.\
\
\{\
  "error": null,\
  "data": \{\
    "id": 50,\
    "code": "A-2025-000050",\
    "status": "OPEN",\
    "serviceType": "DINE_IN",\
    "source": "POS",\
    "tableId": 1,\
    "table": \{\
      "id": 1,\
      "name": "M1",\
      "seats": 4,\
      "isActive": true\
    \},\
    "openedAt": "2025-10-30T17:10:00.000Z",\
    "note": null,\
    "customerName": null,\
    "customerPhone": null,\
    "covers": 1,\
    "subtotalCents": 12000,\
    "discountCents": 0,\
    "serviceFeeCents": 0,\
    "taxCents": 0,\
    "totalCents": 12000,\
    "items": [\
      \{\
        "id": 200,\
        "orderId": 50,\
        "productId": 30,\
        "product": \{\
          "id": 30,\
          "name": "Combo burger + papas",\
          "type": "COMBO"\
        \},\
        "variantId": null,\
        "variant": null,\
        "parentItemId": null,\
        "parentItem": null,\
        "quantity": 1,\
        "status": "NEW",\
        "basePriceCents": 12000,\
        "extrasTotalCents": 0,\
        "totalPriceCents": 12000,\
        "nameSnapshot": "Combo burger + papas",\
        "variantNameSnapshot": null,\
        "notes": null,\
        "modifiers": [],\
        "childItems": [\
          \{\
            "id": 201,\
            "orderId": 50,\
            "productId": 31,\
            "product": \{\
              "id": 31,\
              "name": "Hamburguesa sencilla",\
              "type": "SIMPLE"\
            \},\
            "variantId": null,\
            "variant": null,\
            "parentItemId": 200,\
            "parentItem": \{ "id": 200 \},\
            "childItems": [],\
            "quantity": 1,\
            "status": "NEW",\
            "basePriceCents": 0,\
            "extrasTotalCents": 0,\
            "totalPriceCents": 0,\
            "nameSnapshot": "Hamburguesa sencilla",\
            "variantNameSnapshot": null,\
            "notes": null,\
            "modifiers": []\
          \},\
          \{\
            "id": 202,\
            "orderId": 50,\
            "productId": 32,\
            "product": \{\
              "id": 32,\
              "name": "Papas fritas",\
              "type": "SIMPLE"\
            \},\
            "variantId": null,\
            "variant": null,\
            "parentItemId": 200,\
            "parentItem": \{ "id": 200 \},\
            "childItems": [],\
            "quantity": 1,\
            "status": "NEW",\
            "basePriceCents": 0,\
            "extrasTotalCents": 0,\
            "totalPriceCents": 0,\
            "nameSnapshot": "Papas fritas",\
            "variantNameSnapshot": null,\
            "notes": null,\
            "modifiers": []\
          \}\
        ]\
      \}\
    ],\
    "payments": []\
  \},\
  "message": "OK"\
\}\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Punto clave para el front:
\f0\b0  si item.product.type === "COMBO", 
\f1\b revisa childItems
\f0\b0  para mostrarlos.\
\{\
    "error": null,\
    "data": \{\
        "id": 2,\
        "code": "IM-251030-H8AX",\
        "status": "OPEN",\
        "serviceType": "DELIVERY",\
        "source": "POS",\
        "externalRef": "UBER-ORD-99321",\
        "prepEtaMinutes": 18,\
        "tableId": 1,\
        "openedAt": "2025-10-30T17:12:45.060Z",\
        "acceptedAt": "2025-10-30T17:12:45.059Z",\
        "readyAt": null,\
        "servedAt": null,\
        "closedAt": null,\
        "canceledAt": null,\
        "note": "Sin jitomate en la baguette",\
        "customerName": null,\
        "customerPhone": null,\
        "covers": 3,\
        "servedByUserId": 1,\
        "subtotalCents": 38600,\
        "discountCents": 0,\
        "serviceFeeCents": 0,\
        "taxCents": 0,\
        "totalCents": 38600,\
        "items": [\
            \{\
                "id": 1,\
                "orderId": 2,\
                "productId": 18,\
                "variantId": null,\
                "parentItemId": null,\
                "quantity": 2,\
                "status": "NEW",\
                "basePriceCents": 7700,\
                "extrasTotalCents": 0,\
                "totalPriceCents": 15400,\
                "nameSnapshot": "Marquesita Champi",\
                "variantNameSnapshot": null,\
                "notes": "Mesa 4, lo quiere r\'e1pido",\
                "variant": null,\
                "product": \{\
                    "id": 18,\
                    "name": "Marquesita Champi",\
                    "type": "SIMPLE"\
                \},\
                "modifiers": [\
                    \{\
                        "id": 1,\
                        "orderItemId": 1,\
                        "optionId": 5,\
                        "quantity": 1,\
                        "priceExtraCents": 0,\
                        "nameSnapshot": "Pi\'f1a"\
                    \},\
                    \{\
                        "id": 2,\
                        "orderItemId": 1,\
                        "optionId": 8,\
                        "quantity": 1,\
                        "priceExtraCents": 0,\
                        "nameSnapshot": "Salsa de Pizza"\
                    \}\
                ],\
                "childItems": [],\
                "parentItem": null\
            \},\
            \{\
                "id": 2,\
                "orderId": 2,\
                "productId": 38,\
                "variantId": null,\
                "parentItemId": null,\
                "quantity": 2,\
                "status": "NEW",\
                "basePriceCents": 11600,\
                "extrasTotalCents": 0,\
                "totalPriceCents": 23200,\
                "nameSnapshot": "assas",\
                "variantNameSnapshot": null,\
                "notes": "Mesa 4, lo quiere r\'e1pido",\
                "variant": null,\
                "product": \{\
                    "id": 38,\
                    "name": "assas",\
                    "type": "COMBO"\
                \},\
                "modifiers": [\
                    \{\
                        "id": 3,\
                        "orderItemId": 2,\
                        "optionId": 5,\
                        "quantity": 1,\
                        "priceExtraCents": 0,\
                        "nameSnapshot": "Pi\'f1a"\
                    \},\
                    \{\
                        "id": 4,\
                        "orderItemId": 2,\
                        "optionId": 8,\
                        "quantity": 1,\
                        "priceExtraCents": 0,\
                        "nameSnapshot": "Salsa de Pizza"\
                    \}\
                ],\
                "childItems": [\
                    \{\
                        "id": 3,\
                        "orderId": 2,\
                        "productId": 28,\
                        "variantId": null,\
                        "parentItemId": 2,\
                        "quantity": 2,\
                        "status": "NEW",\
                        "basePriceCents": 0,\
                        "extrasTotalCents": 0,\
                        "totalPriceCents": 0,\
                        "nameSnapshot": "Crepas Saladas",\
                        "variantNameSnapshot": null,\
                        "notes": null\
                    \},\
                    \{\
                        "id": 4,\
                        "orderId": 2,\
                        "productId": 35,\
                        "variantId": null,\
                        "parentItemId": 2,\
                        "quantity": 2,\
                        "status": "NEW",\
                        "basePriceCents": 0,\
                        "extrasTotalCents": 0,\
                        "totalPriceCents": 0,\
                        "nameSnapshot": "Cappuccino",\
                        "variantNameSnapshot": null,\
                        "notes": null\
                    \}\
                ],\
                "parentItem": null\
            \},\
            \{\
                "id": 3,\
                "orderId": 2,\
                "productId": 28,\
                "variantId": null,\
                "parentItemId": 2,\
                "quantity": 2,\
                "status": "NEW",\
                "basePriceCents": 0,\
                "extrasTotalCents": 0,\
                "totalPriceCents": 0,\
                "nameSnapshot": "Crepas Saladas",\
                "variantNameSnapshot": null,\
                "notes": null,\
                "variant": null,\
                "product": \{\
                    "id": 28,\
                    "name": "Crepas Saladas",\
                    "type": "VARIANTED"\
                \},\
                "modifiers": [],\
                "childItems": [],\
                "parentItem": \{\
                    "id": 2\
                \}\
            \},\
            \{\
                "id": 4,\
                "orderId": 2,\
                "productId": 35,\
                "variantId": null,\
                "parentItemId": 2,\
                "quantity": 2,\
                "status": "NEW",\
                "basePriceCents": 0,\
                "extrasTotalCents": 0,\
                "totalPriceCents": 0,\
                "nameSnapshot": "Cappuccino",\
                "variantNameSnapshot": null,\
                "notes": null,\
                "variant": null,\
                "product": \{\
                    "id": 35,\
                    "name": "Cappuccino",\
                    "type": "VARIANTED"\
                \},\
                "modifiers": [],\
                "childItems": [],\
                "parentItem": \{\
                    "id": 2\
                \}\
            \}\
        ],\
        "payments": [],\
        "table": \{\
            "id": 1,\
            "name": "Mesa 1 (actualizada)",\
            "seats": 6,\
            "isActive": false\
        \}\
    \},\
    "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 3: pedido de delivery (no mesa) con cliente\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "error": null,\
  "data": \{\
    "id": 61,\
    "code": "DLV-2025-000061",\
    "status": "OPEN",\
    "serviceType": "DELIVERY",\
    "source": "UBER",\
    "tableId": null,\
    "table": null,\
    "openedAt": "2025-10-30T17:20:00.000Z",\
    "note": "Entregar en recepci\'f3n",\
    "customerName": "Carlos Pacheco",\
    "customerPhone": "3312345678",\
    "covers": null,\
    "subtotalCents": 8500,\
    "discountCents": 0,\
    "serviceFeeCents": 0,\
    "taxCents": 0,\
    "totalCents": 8500,\
    "items": [\
      \{\
        "id": 300,\
        "orderId": 61,\
        "productId": 40,\
        "product": \{\
          "id": 40,\
          "name": "Ensalada C\'e9sar",\
          "type": "SIMPLE"\
        \},\
        "variantId": 5,\
        "variant": \{\
          "id": 5,\
          "productId": 40,\
          "name": "Grande",\
          "priceCents": 8500\
        \},\
        "parentItemId": null,\
        "parentItem": null,\
        "childItems": [],\
        "quantity": 1,\
        "status": "NEW",\
        "basePriceCents": 8500,\
        "extrasTotalCents": 0,\
        "totalPriceCents": 8500,\
        "nameSnapshot": "Ensalada C\'e9sar",\
        "variantNameSnapshot": "Grande",\
        "notes": "Aderezo aparte",\
        "modifiers": []\
      \}\
    ],\
    "payments": []\
  \},\
  "message": "OK"\
\}\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Aqu\'ed aprende el front:
\f0\b0  puede venir table: null y aun as\'ed el pedido es v\'e1lido, porque el serviceType es 
\f1\b DELIVERY
\f0\b0 .\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Caso 4: pedido cerrado con pagos\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "error": null,\
  "data": \{\
    "id": 70,\
    "code": "A-2025-000070",\
    "status": "CLOSED",\
    "serviceType": "DINE_IN",\
    "source": "POS",\
    "tableId": 4,\
    "table": \{\
      "id": 4,\
      "name": "M4",\
      "seats": 6,\
      "isActive": true\
    \},\
    "openedAt": "2025-10-30T16:55:00.000Z",\
    "acceptedAt": "2025-10-30T17:00:00.000Z",\
    "readyAt": "2025-10-30T17:10:00.000Z",\
    "servedAt": "2025-10-30T17:15:00.000Z",\
    "closedAt": "2025-10-30T17:25:00.000Z",\
    "note": null,\
    "customerName": null,\
    "customerPhone": null,\
    "covers": 3,\
    "subtotalCents": 23000,\
    "discountCents": 0,\
    "serviceFeeCents": 0,\
    "taxCents": 0,\
    "totalCents": 23000,\
    "items": [\
      \{\
        "id": 401,\
        "orderId": 70,\
        "productId": 50,\
        "product": \{\
          "id": 50,\
          "name": "Pasta Alfredo",\
          "type": "SIMPLE"\
        \},\
        "variantId": null,\
        "variant": null,\
        "parentItemId": null,\
        "parentItem": null,\
        "childItems": [],\
        "quantity": 1,\
        "status": "SERVED",\
        "basePriceCents": 11000,\
        "extrasTotalCents": 0,\
        "totalPriceCents": 11000,\
        "nameSnapshot": "Pasta Alfredo",\
        "variantNameSnapshot": null,\
        "notes": null,\
        "modifiers": []\
      \},\
      \{\
        "id": 402,\
        "orderId": 70,\
        "productId": 51,\
        "product": \{\
          "id": 51,\
          "name": "Limonada",\
          "type": "SIMPLE"\
        \},\
        "variantId": null,\
        "variant": null,\
        "parentItemId": null,\
        "parentItem": null,\
        "childItems": [],\
        "quantity": 2,\
        "status": "SERVED",\
        "basePriceCents": 6000,\
        "extrasTotalCents": 0,\
        "totalPriceCents": 12000,\
        "nameSnapshot": "Limonada",\
        "variantNameSnapshot": null,\
        "notes": null,\
        "modifiers": []\
      \}\
    ],\
    "payments": [\
      \{\
        "id": 10,\
        "orderId": 70,\
        "method": "CASH",\
        "amountCents": 20000,\
        "tipCents": 0,\
        "paidAt": "2025-10-30T17:23:00.000Z",\
        "receivedByUserId": null,\
        "note": null\
      \},\
      \{\
        "id": 11,\
        "orderId": 70,\
        "method": "CARD",\
        "amountCents": 3000,\
        "tipCents": 0,\
        "paidAt": "2025-10-30T17:24:00.000Z",\
        "receivedByUserId": null,\
        "note": "Resto en tarjeta"\
      \}\
    ]\
  \},\
  "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 3. Crear un pedido con items\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 POST
\f0\b0  /api/orders\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.create\uc0\u8232 
\f1\b Body:
\f0\b0  validado con CreateOrderDto\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Campos\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls8\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f1\b\fs26 Obligatorio:
\f0\b0  serviceType\
\ls8\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f1\b\fs26 Opcionales:
\f0\b0  source, tableId, note, covers, externalRef, prepEtaMinutes\
\ls8\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 status inicial: DRAFT | OPEN | HOLD\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Si se crea en 
\f1\b OPEN
\f0\b0 , se marca 
\f1\b acceptedAt autom\'e1ticamente
\f0\b0 .\
\{\
  "serviceType": "DINE_IN",               // obligatorio: DINE_IN | TAKEAWAY | DELIVERY\
\
  "source": "POS",                        // opcional: POS | UBER | DIDI | RAPPI\
  "tableId": 1,                          // opcional: si es consumo en mesa\
  "covers": 3,                            // opcional: n\'famero de comensales\
  "note": "Sin cebolla en la hamburguesa",// opcional\
  "externalRef": "UBER-ORD-99321",        // opcional: folio de plataforma si escojieron uber didi etc\
  "prepEtaMinutes": 18,                   // opcional: ETA que ve el front/kiosko\
\
  "status": "OPEN"                        // opcional: DRAFT | OPEN | HOLD\
                                          // si no mandas, el backend puede asumir DRAFT\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.1. M\'ednimo-m\'ednimo (pos)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "TAKEAWAY",\
  "source": "POS"\
\}\
Usa defaults:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls9\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 status: OPEN\
\ls9\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 totales: 0\
\ls9\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 items: []\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.2. Sal\'f3n (DINE_IN) con mesa\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "DINE_IN",\
  "source": "POS",\
  "tableId": 3,\
  "covers": 2,\
  "note": "Mesa de la entrada"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.3. Sal\'f3n (DINE_IN) sin mesa todav\'eda\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "DINE_IN",\
  "source": "POS",\
  "covers": 4,\
  "note": "A\'fan no asignan mesa"\
\}\
Luego la mesa se pone con el PATCH de meta.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.4. Para llevar (TAKEAWAY) con nombre\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "TAKEAWAY",\
  "source": "POS",\
  "customerName": "Cliente mostrador",\
  "note": "Pasa en 20 min"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.5. Delivery b\'e1sico\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "DELIVERY",\
  "source": "POS",\
  "customerName": "Carlos",\
  "customerPhone": "3312345678",\
  "note": "Tocar antes de entrar"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.6. Delivery de marketplace (UBER / DIDI / RAPPI)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "DELIVERY",\
  "source": "UBER",\
  "customerName": "Carlos Pacheco",\
  "customerPhone": "3312345678",\
  "externalRef": "UBER#998877",\
  "prepEtaMinutes": 25,\
  "note": "Dejar en recepci\'f3n"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.7. Crear pedido ya en HOLD\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 (para que no salga todav\'eda en cocina / POS)\
\
\{\
  "serviceType": "DINE_IN",\
  "source": "POS",\
  "status": "HOLD",\
  "tableId": 2,\
  "note": "Reservado, a\'fan no ordenan"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.8. Crear pedido como DRAFT\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 (si tu Zod lo acepta igual que HOLD; algunos lo ponen as\'ed)\
\
\{\
  "serviceType": "TAKEAWAY",\
  "source": "POS",\
  "status": "DRAFT",\
  "customerName": "Prueba"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.9. Crear pedido con 1 \'edtem simple (unificado)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "TAKEAWAY",\
  "source": "POS",\
  "items": [\
    \{\
      "productId": 12\
    \}\
  ]\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1.10. Crear pedido con varios \'edtems simples\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "serviceType": "DINE_IN",\
  "source": "POS",\
  "tableId": 5,\
  "items": [\
    \{ "productId": 12, "quantity": 2 \},\
    \{ "productId": 51 \},\
    \{ "productId": 18, "notes": "Sin cebolla" \}\
  ]\
\}\
\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\uc0\u8232 
\f1\b Body:
\f0\b0  AddOrderItemDto\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls10\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Crea un rengl\'f3n con producto, variante y modifiers.\
\ls10\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Si es 
\f1\b combo
\f0\b0  \uc0\u8594  
\f1\b replica los hijos
\f0\b0 .\
\ls10\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Devuelve \{ item \} con 
\f1\b snapshot
\f0\b0  (nombres, precios, estado).\
\ls10\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Al final 
\f1\b recalcula totales
\f0\b0 .\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Ejemplos:\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 1. Caso m\'e1s simple (un producto simple, sin nada extra)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "productId": 12\
\}\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls11\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 El backend lo toma con quantity = 1.\
\ls11\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Sirve para productos tipo 
\f1\b SIMPLE
\f0\b0 .\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 2. Mismo producto pero con cantidad y nota\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "productId": 12,\
  "quantity": 3,\
  "notes": "Sin cebolla, porfa"\
\}\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls12\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 \'datil para cocina / KDS, porque la nota viaja al renglon.\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 3. Producto con variantes (el backend en tu zip dice: \'93si es VARIANTED y no mandas variantId, truena\'94)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "productId": 25,\
  "variantId": 3,\
  "quantity": 1\
\}\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls13\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Aqu\'ed el productId es el producto padre (ej. \'93Pizza\'94)\
\ls13\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 El variantId es la presentaci\'f3n (ej. \'93Grande\'94, \'93Mediana\'94, \'93Pepperoni grande\'94).\
\ls13\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Si no mandas variantId y ese producto es VARIANTED \uc0\u8594  el repo te lanza: 
\f1\b "variantId requerido para producto VARIANTED"
\f0\b0  (eso est\'e1 en PrismaOrderRepository.ts).\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 4. Producto con modificadores (extras, toppings, salsas\'85)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "productId": 18,\
  "quantity": 2,\
  "modifiers": [\
    \{\
      "optionId": 7\
    \},\
    \{\
      "optionId": 9,\
      "quantity": 2\
    \}\
  ]\
\}\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls14\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Cada optionId debe existir en tus 
\f1\b modifierOptions
\f0\b0 .\
\ls14\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 El backend busca esos optionId, suma el priceExtraCents y lo mete al rengl\'f3n.\
\ls14\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Si no encuentra alguno, lo ignora (no te truena la petici\'f3n).\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 5. Producto con todo: variante + modificadores + nota\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "productId": 25,\
  "variantId": 4,\
  "quantity": 1,\
  "notes": "Partir en 8",\
  "modifiers": [\
    \{ "optionId": 10 \},           // extra queso\
    \{ "optionId": 12, "quantity": 2 \}  // 2 salsas\
  ]\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 6. Combo (el repo detecta que es COMBO y crea los hijos solo)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "productId": 30,\
  "quantity": 1\
\}\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls15\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 En tu repo (PrismaOrderRepository) si el 
\f1\b product.type === "COMBO"
\f0\b0  despu\'e9s de crear el \'edtem 
\f1\b crea los renglones hijos
\f0\b0  con los componentes del combo.\
\ls15\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Por eso el front no tiene que mandar los hijos, solo el combo.\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 7. Ejemplo \'93did\'e1ctico\'94 con comentarios (para tu equipo)\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 Ojo:
\f0\b0  JSON real no lleva comentarios, esto es solo para que lo copien y lo limpien.\
\
\{\
  "productId": 18,              // obligatorio\
  "variantId": 2,                // opcional, si el producto lo requiere\
  "quantity": 2,                 // default = 1\
  "notes": "Mesa 4, lo quiere r\'e1pido", // opcional\
  "modifiers": [\
    \{\
      "optionId": 5,             // ej. "Coca 600"\
      "quantity": 1\
    \},\
    \{\
      "optionId": 8,             // ej. "Sin gluten"\
      "quantity": 1\
    \}\
  ]\
\}\
\
\
Respuesta :\uc0\u8232 \{\
    "error": null,\
    "data": \{\
        "item": \{\
            "id": 1,\
            "orderId": 2,\
            "productId": 18,\
            "variantId": null,\
            "parentItemId": null,\
            "quantity": 2,\
            "status": "NEW",\
            "basePriceCents": 7700,\
            "extrasTotalCents": 0,\
            "totalPriceCents": 15400,\
            "nameSnapshot": "Marquesita Champi",\
            "variantNameSnapshot": null,\
            "notes": "Mesa 4, lo quiere r\'e1pido"\
        \}\
    \},\
    "message": "Item added"\
\}\
\

\f1\b Respuesta:
\f0\b0  pedido creado (data con el pedido).\
\{\
    "error": null,\
    "data": \{\
        "id": 1,\
        "code": "IM-251030-LR97",\
        "status": "OPEN",\
        "serviceType": "DINE_IN",\
        "source": "POS",\
        "externalRef": "UBER-ORD-99321",\
        "prepEtaMinutes": 18,\
        "tableId": 1,\
        "openedAt": "2025-10-30T17:08:53.722Z",\
        "acceptedAt": "2025-10-30T17:08:53.719Z",\
        "readyAt": null,\
        "servedAt": null,\
        "closedAt": null,\
        "canceledAt": null,\
        "note": "Sin cebolla en la hamburguesa",\
        "customerName": null,\
        "customerPhone": null,\
        "covers": 3,\
        "servedByUserId": 1,\
        "subtotalCents": 0,\
        "discountCents": 0,\
        "serviceFeeCents": 0,\
        "taxCents": 0,\
        "totalCents": 0\
    \},\
    "message": "Created"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 4. Actualizar metadatos del pedido\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 PATCH
\f0\b0  /api/orders/:id/meta\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\uc0\u8232 
\f1\b Body:
\f0\b0  UpdateOrderMetaDto\
Permite actualizar 
\f1\b parcialmente
\f0\b0 :\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls16\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 tableId\
\ls16\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 note\
\ls16\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 covers\
\ls16\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 prepEtaMinutes\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Para limpiar un campo: 
\f1\b mandar null
\f0\b0  (mesa, cubiertos o ETA).\
Ejemplo\uc0\u8232 \{\
  "tableId": 1,\
  "covers": 4,\
  "note": "Mesa movida",\
  "prepEtaMinutes": 8\
\}\
Ejemplos;\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Casos posibles (todos los que tiene sentido mandar)\
1. Cambiar de mesa\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "tableId": 7\
\}\
\uc0\u55357 \u56393  Pasa de la mesa que ten\'eda a la 
\f1\b mesa 7
\f0\b0 .\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 2. Quitar la mesa (dejarlo sin mesa)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "tableId": null\
\}\
\uc0\u55357 \u56393  Esto est\'e1 permitido porque el Zod lo puso como nullable. El repo lo guarda como null.\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 3. Poner / cambiar la nota\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "note": "Cumplea\'f1os, traer pastel"\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 4. Limpiar la nota\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "note": null\
\}\
\uc0\u55357 \u56393  Queda sin nota.\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 5. Actualizar n\'famero de comensales (covers)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "covers": 4\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 6. Quitar los comensales (dejarlo sin valor)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "covers": null\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 7. Poner tiempo estimado de preparaci\'f3n (para KDS / delivery)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "prepEtaMinutes": 20\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 8. Quitar el tiempo estimado\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "prepEtaMinutes": null\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 9. Cambiar mesa y nota al mismo tiempo\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "tableId": 4,\
  "note": "Pasar primero las bebidas"\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 10. Mesa + covers\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "tableId": 2,\
  "covers": 3\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 11. Todo junto (caso \'93editar encabezado\'94 en el front)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\
  "tableId": 5,\
  "note": "Cliente frecuente",\
  "covers": 2,\
  "prepEtaMinutes": 15\
\}\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 12. Body vac\'edo (el backend lo acepta, pero no cambia nada)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \
\{\}\
\uc0\u55357 \u56393  El repo ve que no hay campos y sale sin actualizar. \'datil para probar que no truena.\
\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 13. Quitar varias cosas a la vez\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 (por ejemplo: lo pasaste a delivery y ya no quieres mesa ni covers ni nota)\
\
\{\
  "tableId": null,\
  "covers": null,\
  "note": null\
\}\
\uc0\u8232 \
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Respuesta:
\f0\b0  200 con data: null.\
\{\
    "error": null,\
    "data": null,\
    "message": "Updated"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 5. Cambiar el estado del pedido\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 PATCH
\f0\b0  /api/orders/:id/status\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\uc0\u8232 
\f1\b Body:
\f0\b0  UpdateOrderStatusDto\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Transiciones permitidas\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls17\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 DRAFT \uc0\u8594  OPEN, HOLD, CANCELED\
\ls17\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 OPEN \uc0\u8594  HOLD, CANCELED, CLOSED\
\ls17\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 HOLD \uc0\u8594  OPEN, CANCELED\
\ls17\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 CLOSED o CANCELED \uc0\u8594  
\f1\b no se mueven\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0 \cf0 \{\
  "status": "CLOSED"\
\}\
\{\
    "error": null,\
    "data": null,\
    "message": "Updated"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Reglas extra\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls18\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Al cerrar (
\f1\b CLOSED
\f0\b0 ) se:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls18\ilvl1\cf0 {\listtext	0.	}
\f1\b recalcular totales
\f0\b0 \
{\listtext	0.	}
\f1\b validar
\f0\b0  que pagos + propinas >= total\
{\listtext	0.	}si no cubre \uc0\u8594  
\f1\b 409
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls18\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Se actualizan autom\'e1ticamente los timestamps:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls18\ilvl1
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 acceptedAt\
\ls18\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 readyAt\
\ls18\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 servedAt\
\ls18\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 closedAt\
\ls18\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 canceledAt\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Casos :\uc0\u8232 
\f1\b\fs40 TODOS los casos que puedes mandar\
\pard\pardeftab560\sa40\partightenfactor0

\fs32 \cf0 1. Pasar de OPEN \uc0\u8594  HOLD\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "HOLD"\
\}\
\'datil cuando el mesero \'93lo est\'e1 armando\'94 pero no quiere que avance.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 2. Volver de HOLD \uc0\u8594  OPEN\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "OPEN"\
\}\
Para reactivarlo en listas y en KDS.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 3. Marcar que la casa ya acept\'f3 el pedido (p. ej. delivery)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "ACCEPTED"\
\}\
El repo va a poner:\
\
acceptedAt = now()\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 4. Marcar que ya est\'e1 listo (cocina termin\'f3)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "READY"\
\}\
El repo:\
\
readyAt = now()\
Esto hace que el KDS lo pueda mandar a columna \'93listos\'94.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 5. Marcar que ya se sirvi\'f3 (para DINE_IN)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "SERVED"\
\}\
El repo:\
\
servedAt = now()\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 6. Cerrar pedido (CLOSED) 
\f0\b0 \uc0\u55357 \u56496 
\f1\b \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "CLOSED"\
\}\
\uc0\u55357 \u56628  Aqu\'ed entra la regla que te pusieron en la instrucci\'f3n:\
\'93no permite cerrar si paidTotal < total\'94\
O sea, el repo hace algo as\'ed:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls19\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 suma payments.amountCents\
\ls19\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 compara con order.totalCents\
\ls19\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 si es 
\f1\b menor
\f0\b0  \uc0\u8594  responde error\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Respuesta si NO est\'e1 pagado:
\f0\b0 \
\
\{\
  "error": \{\
    "code": 400,\
    "details": "Order cannot be closed because it is not fully paid"\
  \},\
  "data": null,\
  "message": "Order not fully paid"\
\}\

\f1\b Respuesta si S\'cd est\'e1 pagado:
\f0\b0 \
\
\{\
  "error": null,\
  "data": \{\
    "id": 145,\
    "status": "CLOSED",\
    "closedAt": "2025-10-30T18:30:00.000Z",\
    "payments": [\
      \{ "id": 1, "amountCents": 23000 \}\
    ],\
    "totalCents": 23000,\
    "...": "..."\
  \},\
  "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 7. Cancelar pedido\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "CANCELED",\
  "reason": "El cliente se fue"\
\}\
El repo:\
\
canceledAt = now()\
y guarda el motivo si lo mapeaste en el modelo.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 8. Cancelar SIN motivo\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "CANCELED"\
\}\
V\'e1lido porque el DTO lo pone como opcional.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 9. \'93Revivir\'94 un pedido en HOLD que estaba con tiempo\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "OPEN"\
\}\
(igual que el caso 2, pero lo uso mucho en front)\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 10. Intentar cerrar un pedido que tiene 0 pagos \uc0\u8594  debe fallar\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "CLOSED"\
\}\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Respuesta esperada:
\f0\b0 \
\
\{\
  "error": \{\
    "code": 400,\
    "details": "Order cannot be closed because it is not fully paid"\
  \},\
  "data": null,\
  "message": "Order not fully paid"\
\}\
Esto es EXACTAMENTE lo que te ped\'edan: \'93no permite cerrar\'85\'94\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 11. Ponerlo ACCEPTED y de una READY (dos llamadas)\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls20\ilvl0
\f0\b0\fs26 \cf0 {\listtext	0.	}\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\{ "status": "ACCEPTED" \}\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls21\ilvl0\cf0 {\listtext	0.	}\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\{ "status": "READY" \}\
Esto lo hacen algunas pantallas de cocina.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 12. Pasar de READY \uc0\u8594  SERVED \u8594  CLOSED\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls22\ilvl0
\f0\b0\fs26 \cf0 {\listtext	0.	}\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\{ "status": "SERVED" \}\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls23\ilvl0\cf0 {\listtext	0.	}(cuando ya pag\'f3)\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\{ "status": "CLOSED" \}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 13. Pedido de delivery que nunca lleg\'f3 \uc0\u8594  cancel\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "CANCELED",\
  "reason": "Rechazado por el repartidor"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 14. Pedido de app que quieres reactivar \uc0\u8594  OPEN\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "status": "OPEN"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 15. Body vac\'edo (no hace nada, pero lo pongo para pruebas)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\}\
El Zod te va a decir algo como \'93status is required\'94, porque este s\'ed es de los que 
\f1\b S\'cd requieren
\f0\b0  el campo.\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Respuesta de validaci\'f3n:
\f0\b0 \
\
\{\
  "error": \{\
    "code": 400,\
    "details": "status is required"\
  \},\
  "data": null,\
  "message": "Validation failed"\
\}\
\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 6. Listado para KDS\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 GET
\f0\b0  /api/orders/kds/list\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.read\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Query\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls24\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 statuses: CSV, ej. NEW,READY\
\ls24\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 El backend:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls24\ilvl1
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 lo pasa a 
\f1\b may\'fasculas
\f0\b0 \
\ls24\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f1\b\fs26 ignora
\f0\b0  estados inv\'e1lidos\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Respuesta\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 Tarjetas KDS con:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls25\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 itemId\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 orderId\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 status\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 quantity\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 name\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 variant\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 tableName\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 code\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 serviceType\
\ls25\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 parentItemId\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 entonces /api/orders/kds/list es la 
\f1\b versi\'f3n recortada para KDS
\f0\b0 : solo lo que la cocina necesita ver r\'e1pido, sin pagos, sin cliente de m\'e1s, sin totales complejos, y enfocada en 
\f1\b \'edtems que todav\'eda no est\'e1n servidos
\f0\b0 .\
Como tu ZIP no trae el nombre tal cual indexado, te lo armo siguiendo el mismo patr\'f3n que ya traes en \'f3rdenes (status, serviceType, source, items con modifiers, combos con hijos) para que lo puedas pegar.\
Te dejo 
\f1\b todos los casos posibles
\f0\b0  que tendr\'eda sentido que devuelva este endpoint en tu backend.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Endpoint\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
GET /api/orders/kds/list\
permiso: orders.read   // o kds.read, pero en tu proyecto todo lo de orders est\'e1 bajo orders.read\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Query params t\'edpicos (los mismos que usas en /api/orders, pero \'93kitchenizados\'94)\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls26\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 statuses \uc0\u8594  CSV de estados de \'edtems/\'f3rdenes que cocina quiere ver, ej: NEW,IN_PROGRESS\
\ls26\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 serviceType \uc0\u8594  DINE_IN | TAKEAWAY | DELIVERY\
\ls26\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 source \uc0\u8594  POS | UBER | DIDI | RAPPI\
\ls26\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 from / to \uc0\u8594  rango de fecha/hora de apertura\
\ls26\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 (opcional) tableId \uc0\u8594  para mostrar solo las mesas\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 La 
\f1\b idea
\f0\b0 : la cocina pide esta lista cada X segundos y la pantalla se refresca.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 Forma de la respuesta (propuesta coherente con tu API)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 Responde con wrapper como siempre:\
\
\{\
  "error": null,\
  "data": [ /* tickets kds */ ],\
  "message": "OK"\
\}\
y cada ticket de KDS as\'ed:\
\
\{\
  "orderId": 71,\
  "code": "A-2025-000071",\
  "status": "OPEN",\
  "serviceType": "DINE_IN",\
  "source": "POS",\
  "openedAt": "2025-10-30T17:32:00.000Z",\
  "table": \{ "id": 2, "name": "M2" \},\
  "note": "Mesa de la entrada",\
  "prepEtaMinutes": null,\
  "customerName": null,\
  "items": [\
    \{\
      "id": 9001,\
      "productId": 12,\
      "name": "Torta ahogada",\
      "variantName": null,\
      "quantity": 2,\
      "status": "NEW",              // para cocina\
      "notes": "Poquita salsa",\
      "modifiers": [\
        \{ "name": "Sin cebolla", "quantity": 1 \}\
      ],\
      "isComboParent": false,\
      "children": []\
    \}\
  ]\
\}\
F\'edjate que:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls27\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 no mando pagos\
\ls27\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 no mando totales en centavos (cocina no los necesita)\
\ls27\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 s\'ed mando items ya \'93traducidos\'94 (con nombreSnapshot)\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 CASOS 
\f0\b0 \uc0\u55358 \u56810 
\f1\b \
1. DINE_IN sencillo, 1 item\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "error": null,\
  "data": [\
    \{\
      "orderId": 71,\
      "code": "A-2025-000071",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "openedAt": "2025-10-30T17:32:00.000Z",\
      "table": \{ "id": 2, "name": "M2" \},\
      "note": "Mesa de la entrada",\
      "prepEtaMinutes": null,\
      "customerName": null,\
      "items": [\
        \{\
          "id": 9001,\
          "productId": 12,\
          "name": "Torta ahogada",\
          "variantName": null,\
          "quantity": 2,\
          "status": "NEW",\
          "notes": "Poquita salsa",\
          "modifiers": [],\
          "isComboParent": false,\
          "children": []\
        \}\
      ]\
    \}\
  ],\
    "message": "OK"\
\}\
\uc0\u55357 \u56393  \'dasalo para la pantalla principal de cocina.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 2. DELIVERY (no mesa) con variante y modifier\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "error": null,\
  "data": [\
    \{\
      "orderId": 88,\
      "code": "DLV-2025-000088",\
      "status": "OPEN",\
      "serviceType": "DELIVERY",\
      "source": "UBER",\
      "openedAt": "2025-10-30T17:40:00.000Z",\
      "table": null,\
      "note": "Dejar en recepci\'f3n",\
      "prepEtaMinutes": 25,\
      "customerName": "Carlos Pacheco",\
      "items": [\
        \{\
          "id": 9100,\
          "productId": 40,\
          "name": "Ensalada C\'e9sar",\
          "variantName": "Grande",\
          "quantity": 1,\
          "status": "NEW",\
          "notes": "Aderezo aparte",\
          "modifiers": [\
            \{ "name": "Aderezo extra", "quantity": 1 \}\
          ],\
          "isComboParent": false,\
          "children": []\
        \}\
      ]\
    \}\
  ],\
  "message": "OK"\
\}\
\uc0\u55357 \u56393  Aqu\'ed cocina ve: es delivery, es Uber, cliente, nota, y qu\'e9 preparar.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 3. Pedido con COMBO (pap\'e1 + hijos)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 Este es el que m\'e1s confunde al front, as\'ed que as\'ed debe verse en KDS:\
\
\{\
  "error": null,\
  "data": [\
    \{\
      "orderId": 90,\
      "code": "A-2025-000090",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "openedAt": "2025-10-30T17:45:00.000Z",\
      "table": \{ "id": 4, "name": "M4" \},\
      "note": null,\
      "prepEtaMinutes": null,\
      "customerName": null,\
      "items": [\
        \{\
          "id": 9200,\
          "productId": 30,\
          "name": "Combo burger + papas",\
          "variantName": null,\
          "quantity": 1,\
          "status": "NEW",\
          "notes": null,\
          "modifiers": [],\
          "isComboParent": true,\
          "children": [\
            \{\
              "id": 9201,\
              "name": "Hamburguesa sencilla",\
              "quantity": 1,\
              "status": "NEW",\
              "notes": null,\
              "modifiers": []\
            \},\
            \{\
              "id": 9202,\
              "name": "Papas fritas",\
              "quantity": 1,\
              "status": "NEW",\
              "notes": null,\
              "modifiers": []\
            \}\
          ]\
        \}\
      ]\
    \}\
  ],\
  "message": "OK"\
\}\
\uc0\u55357 \u56393  Nota: en tu repo los 
\f1\b childItems
\f0\b0  ven\'edan sin product, por eso en KDS conviene mandarlos ya \'93planchados\'94 con name.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 4. Pedido con 2 \'edtems en distintos estados (NEW y IN_PROGRESS)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 Esto es t\'edpico de KDS:\
\
\{\
  "error": null,\
  "data": [\
    \{\
      "orderId": 91,\
      "code": "A-2025-000091",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "openedAt": "2025-10-30T17:55:00.000Z",\
      "table": \{ "id": 7, "name": "M7" \},\
      "items": [\
        \{\
          "id": 9300,\
          "productId": 18,\
          "name": "Chilaquiles rojos",\
          "variantName": null,\
          "quantity": 1,\
          "status": "IN_PROGRESS",\
          "notes": "Extra pollo",\
          "modifiers": [\
            \{ "name": "Pollo extra", "quantity": 1 \}\
          ],\
          "isComboParent": false,\
          "children": []\
        \},\
        \{\
          "id": 9301,\
          "productId": 51,\
          "name": "Limonada",\
          "variantName": null,\
          "quantity": 1,\
          "status": "NEW",\
          "notes": null,\
          "modifiers": [],\
          "isComboParent": false,\
          "children": []\
        \}\
      ]\
    \}\
  ],\
  "message": "OK"\
\}\
\uc0\u55357 \u56393  As\'ed el front puede pintar columnas por estado.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 5. Filtro por estado\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 Request
\f0\b0 \
\
GET /api/orders/kds/list?statuses=NEW,IN_PROGRESS\

\f1\b Response
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{ "orderId": 71, "...": "..." \},\
    \{ "orderId": 90, "...": "..." \}\
  ],\
  "message": "OK"\
\}\
\uc0\u55357 \u56393  Cocina no ve los que ya est\'e1n READY/SERVED.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 6. Filtro por tipo de servicio (solo delivery)\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 Request
\f0\b0 \
\
GET /api/orders/kds/list?serviceType=DELIVERY\

\f1\b Response
\f0\b0 \
\
\{\
  "error": null,\
  "data": [\
    \{\
      "orderId": 88,\
      "code": "DLV-2025-000088",\
      "serviceType": "DELIVERY",\
      "source": "UBER",\
      "items": [ /* ... */ ]\
    \}\
  ],\
  "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 7. Pedido ya listo (READY) que igual se muestra\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 Si tu KDS muestra los que ya est\'e1n listos para que el mesero los recoja:\
\
\{\
  "error": null,\
  "data": [\
    \{\
      "orderId": 95,\
      "code": "A-2025-000095",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "source": "POS",\
      "openedAt": "2025-10-30T18:05:00.000Z",\
      "table": \{ "id": 9, "name": "Terraza" \},\
      "items": [\
        \{\
          "id": 9400,\
          "name": "Molletes",\
          "quantity": 1,\
          "status": "READY",\
          "notes": null,\
          "modifiers": [],\
          "isComboParent": false,\
          "children": []\
        \}\
      ]\
    \}\
  ],\
  "message": "OK"\
\}\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 8. Pedido con nota general + nota en \'edtem\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "error": null,\
  "data": [\
    \{\
      "orderId": 99,\
      "code": "A-2025-000099",\
      "status": "OPEN",\
      "serviceType": "DINE_IN",\
      "table": \{ "id": 10, "name": "M10" \},\
      "note": "Alergia a mariscos",         // nota del pedido\
      "items": [\
        \{\
          "id": 9500,\
          "name": "Pasta Alfredo",\
          "quantity": 1,\
          "status": "NEW",\
          "notes": "Sin camar\'f3n",           // nota del \'edtem\
          "modifiers": [],\
          "isComboParent": false,\
          "children": []\
        \}\
      ]\
    \}\
  ],\
  "message": "OK"\
\}\
\uc0\u55357 \u56393  Esto es importante que lo pintes doble en cocina.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 9. Sin resultados (filtro muy cerrado)\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\{\
  "error": null,\
  "data": [],\
  "message": "OK"\
\}\
\uc0\u55357 \u56393  El front tiene que mostrar \'93no hay tickets\'94.\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 7. \'cdtems del pedido\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\b0\fs26 \cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 7.2 Actualizar \'edtem\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 PATCH
\f0\b0  /api/orders/items/:itemId\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\uc0\u8232 
\f1\b Body:
\f0\b0  UpdateOrderItemDto\
Permite:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls28\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 cambiar quantity\
\ls28\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 cambiar notes\
\ls28\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f1\b\fs26 reemplazar modifiers
\f0\b0 \
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 El backend:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls29\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 ajusta extras\
\ls29\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 actualiza combos hijos\
\ls29\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f1\b\fs26 recalcula totales
\f0\b0 \
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
Casos:\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 O sea: 
\f4\b solo
\f3\b0  puedes tocar estas 3 cosas:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls30\ilvl0
\f5\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 quantity
\f3\fs24  \uc0\u8594  cambiar cantidad\
\ls30\ilvl0
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 notes
\f3\fs24  \uc0\u8594  cambiar nota del rengl\'f3n\
\ls30\ilvl0
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 replaceModifiers
\f3\fs24  \uc0\u8594  
\f4\b reemplazar TODOS
\f3\b0  los modifiers que ten\'eda el item por estos nuevos\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 No puedes:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls31\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 cambiar 
\f5\fs26 productId
\f3\fs24 \
\ls31\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 cambiar 
\f5\fs26 variantId
\f3\fs24 \
\ls31\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 cambiar 
\f5\fs26 price
\f3\fs24  directo\
\ls31\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 cambiar el estado del item (eso es otra ruta: 
\f5\fs26 PATCH /api/orders/items/:itemId/status
\f3\fs24 )\
\ls31\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 cambiar el pedido (eso ya lo hace internamente el repo cuando recalcula)\
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 Qu\'e9 hace el repo (esto es lo importante del zip)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 En 
\f5\fs26 PrismaOrderRepository.updateItem(...)
\f3\fs24  hace esto:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls32\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Busca el item 
\f4\b con
\f3\b0 :\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls32\ilvl1
\f5\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 product
\f3\fs24  (para ver si es combo)\
\ls32\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 modifiers
\f3\fs24  actuales\
\ls32\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 childItems
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls32\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Si mandaste 
\f6\fs26 replaceModifiers
\f4\fs24 :
\f3\b0 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls32\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 borra todos los modifiers actuales del item\
\ls32\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 busca las opciones que mandaste\
\ls32\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 crea los nuevos modifiers con su 
\f5\fs26 priceExtraCents
\f3\fs24  y 
\f5\fs26 nameSnapshot
\f3\fs24 \
\ls32\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 suma los extras (extrasTotalCents)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls32\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Calcula:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls32\ilvl1
\f5\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 newQty = body.quantity ?? current.quantity
\f3\fs24 \
\ls32\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 totalUnit = basePriceCents + extras
\f3\fs24 \
\ls32\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 totalPriceCents = totalUnit * newQty
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls32\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Actualiza el item con:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls32\ilvl1
\f5\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 quantity
\f3\fs24 \
\ls32\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 notes
\f3\fs24 \
\ls32\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 extrasTotalCents
\f3\fs24 \
\ls32\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 totalPriceCents
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls32\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Si el item es combo padre
\f3\b0  (tiene 
\f5\fs26 childItems
\f3\fs24 ):\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls32\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 escala las cantidades de los hijos para que sigan al pap\'e1\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls32\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Llama a 
\f5\fs26 recalcTotalsTx(...)
\f3\fs24  \uc0\u8594  
\f4\b recalcula los totales del pedido
\f3\b0  \uc0\u55357 \u56392 \
\pard\pardeftab720\sa240\partightenfactor0
\cf0 Listo. Ahora s\'ed vamos con 
\f4\b TODOS los casos
\f3\b0  que tiene sentido mandar.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 CASOS \uc0\u9989 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 1. Cambiar solo la cantidad\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "quantity": 3\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls33\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Sube de lo que tenga (ej. 1) a 3\
\ls33\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula 
\f5\fs26 totalPriceCents
\f3\fs24 \
\ls33\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula totales del pedido\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 2. Cambiar solo la nota\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "notes": "Sin cebolla, porfa"\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls34\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 No toca quantity\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 No toca modifiers\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \'datil cuando cocina quiere dejar aclaraci\'f3n\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 3. Cambiar cantidad y nota\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "quantity": 2,\
  "notes": "Para mesa 4"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 4. Reemplazar todos los modifiers por estos\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "replaceModifiers": [\
    \{ "optionId": 7 \},\
    \{ "optionId": 9, "quantity": 2 \}\
  ]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Esto hace exactamente:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls35\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 borra los modifiers que ten\'eda ese item\
\ls35\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 crea 
\f4\b solo
\f3\b0  estos 2\
\ls35\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 suma sus extras\
\ls35\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 recalcula el total del item\
\ls35\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 recalcula el total del pedido\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 5. Quitar todos los modifiers\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 (esto es lo chido: se hace mandando un array vac\'edo \uc0\u55357 \u56391 )\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "replaceModifiers": []\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 El repo:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls36\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 borra todos los modifiers\
\ls36\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 extrasTotalCents = 0\
\ls36\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 totalPriceCents = basePriceCents * quantity\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 6. Cambiar cantidad y reemplazar modifiers\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "quantity": 3,\
  "replaceModifiers": [\
    \{ "optionId": 10 \}\
  ]\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls37\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Sube cantidad a 3\
\ls37\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Borra modifiers viejos\
\ls37\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Mete el 10\
\ls37\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula total (base + extra) * 3\
\ls37\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula totales del pedido\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 7. Cambiar solo un modifier pero dejando los dem\'e1s\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 \uc0\u55357 \u56393  Esto 
\f4\b NO
\f3\b0  se puede con esta ruta, porque el campo es 
\f6\b\fs26 replaceModifiers
\f3\b0\fs24 .\uc0\u8232 Si lo mandas, 
\f4\b reemplaza todos
\f3\b0 .\uc0\u8232 O sea, si quieres \'93agregar uno m\'e1s y dejar los otros\'94, tienes que:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls38\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 traer la lista actual\
\ls38\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 sumarle el nuevo\
\ls38\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 mandarla completa en 
\f5\fs26 replaceModifiers
\f3\fs24 \
\pard\pardeftab720\sa240\partightenfactor0
\cf0 Ejemplo:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "replaceModifiers": [\
    \{ "optionId": 5 \},\
    \{ "optionId": 6 \},\
    \{ "optionId": 9, "quantity": 2 \}\
  ]\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 8. Item que es combo padre \uc0\u8594  cambiar cantidad\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "quantity": 2\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Como en el repo se ve:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls39\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 ve que el item tiene 
\f5\fs26 childItems
\f3\fs24 \
\ls39\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 calcula cu\'e1nto tra\'eda cada hijo por cada 1 del pap\'e1\
\ls39\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 los vuelve a escribir multiplicados por 2\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \uc0\u55357 \u57315  Ejemplo:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls40\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 antes: combo padre 
\f5\fs26 qty=1
\f3\fs24 , hijo papas 
\f5\fs26 qty=1
\f3\fs24 \
\ls40\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 PATCH padre a 
\f5\fs26 qty=2
\f3\fs24 \
\ls40\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 repo deja hijo papas en 
\f5\fs26 qty=2
\f3\fs24 \
\ls40\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 y recalcula totales\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 9. Item que es combo padre \uc0\u8594  cambiar nota\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "notes": "Una coca sin hielo"\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls41\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Solo cambia la nota del padre\
\ls41\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Los hijos se quedan igual\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 10. Item que es combo padre \uc0\u8594  reemplazar modifiers\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "replaceModifiers": [\
    \{ "optionId": 21 \}\
  ]\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls42\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Solo reemplaza los modifiers del 
\f4\b padre
\f3\b0 \
\ls42\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Los hijos no los toca\
\ls42\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula totales\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 11. Item que es combo hijo (o sea, le pegas al 
\f6\fs30\fsmilli15210 itemId
\f4\fs28  del hijo)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Esto tambi\'e9n funciona, porque el repo hace 
\f5\fs26 findUnique
\f3\fs24  por item. Si el item no tiene hijos, no escala nada.\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "quantity": 2,\
  "notes": "Este va sin sal"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 12. Cambiar nota y quitar modifiers\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "notes": "Muy picante",\
  "replaceModifiers": []\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 13. Actualizar solo modifiers con cantidades\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "replaceModifiers": [\
    \{ "optionId": 15, "quantity": 3 \},\
    \{ "optionId": 18, "quantity": 1 \}\
  ]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 El repo busca esos optionId; si uno 
\f4\b no existe
\f3\b0 , tira:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
Modifier option 15 inv\'e1lido\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 y tu controller responde 500.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 14. Body vac\'edo (para probar validaci\'f3n)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 El Zod lo acepta porque todo es opcional, peeero el update no cambiar\'e1 nada. Igual te responde:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": null,\
  "data": null,\
  "message": "Updated"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 (esto pasa as\'ed porque en el usecase solo pasa lo que lleg\'f3)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 15. 
\f6\fs30\fsmilli15210 quantity
\f4\fs28  = 0 (esto NO te lo va a aceptar)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "quantity": 0\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Tu Zod pide 
\f5\fs26 int().positive()
\f3\fs24 , as\'ed que te va a regresar 400:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 400,\
    "details": "quantity must be greater than 0"\
  \},\
  "data": null,\
  "message": "Validation failed"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 16. Modifier que no existe \uc0\u8594  error\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "replaceModifiers": [\
    \{ "optionId": 999999 \}\
  ]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta (del controller):\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 500,\
    "details": "Modifier option 999999 inv\'e1lido"\
  \},\
  "data": null,\
  "message": "Error updating order item"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 (El 500 es porque el repo lanz\'f3 error directo.)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 17. Cambiar cantidad de combo padre de 3 \uc0\u8594  1 (baja hijos)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "quantity": 1\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 El repo calcula:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls43\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 antes: padre=3, hijo=3\
\ls43\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 ahora: padre=1 \uc0\u8594  hijo=1\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 7.3 Cambiar estado de un \'edtem\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 PATCH
\f0\b0  /api/orders/items/:itemId/status\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\uc0\u8232 
\f1\b Body:
\f0\b0  UpdateOrderItemStatusDto\
Flujo permitido:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls44\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 NEW \uc0\u8594  IN_PROGRESS \u8594  READY \u8594  SERVED\
\ls44\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 o CANCELED en cualquier punto\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Reglas:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls45\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 si 
\f1\b todos
\f0\b0  los \'edtems quedan READY/SERVED \uc0\u8594  se marca readyAt\
\ls45\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 si 
\f1\b todos
\f0\b0  quedan SERVED \uc0\u8594  se marca servedAt\
\ls45\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 si hay 
\f1\b cancelaciones
\f0\b0  \uc0\u8594  se 
\f1\b recalculan totales
\f0\b0 \
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 Casos:\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 El patr\'f3n es igualito al de la orden, pero a nivel 
\f4\b item
\f3\b0 :\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls46\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Lee 
\f5\fs26 :itemId
\f3\fs24  y lo fuerza a n\'famero.\
\ls46\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Valida el body con un Zod tipo:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls46\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   status: z.enum(["NEW","IN_PROGRESS","READY","SERVED","CANCELED"]),\
\ls46\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   reason?: z.string().optional()\
\ls46\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \}\
\ls46\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls46\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Llama al repo: 
\f5\fs26 orderRepository.updateItemStatus(itemId, dto)
\f3\fs24 \
\ls46\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 El repo:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls46\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 actualiza 
\f4\b solo ese rengl\'f3n
\f3\b0 \
\ls46\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 si el rengl\'f3n es 
\f4\b combo padre
\f3\b0 , suele 
\f4\b propagar
\f3\b0  el estado a los hijos (al menos para READY / CANCELED), porque si no en KDS se desincroniza\
\ls46\ilvl1
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 recalcula los totales del pedido
\f3\b0  (para no dejar totales colgados cuando cancelas)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls46\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Devuelve el pedido o el item actualizado dentro del wrapper:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 \{ "error": null, "data": \{ ... \}, "message": "OK" \}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls46\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 
\f3\fs24 \
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Los 
\f4\b estados de ITEM
\f3\b0  que ya vimos en tu API (por KDS y por lo que regresa el GET) son:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls47\ilvl0
\f5\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 NEW
\f3\fs24 \
\ls47\ilvl0
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 IN_PROGRESS
\f3\fs24 \
\ls47\ilvl0
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 READY
\f3\fs24 \
\ls47\ilvl0
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 SERVED
\f3\fs24 \
\ls47\ilvl0
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 CANCELED
\f3\fs24 \
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 (son los mismos que ya usaste en 
\f5\fs26 /api/orders/kds/list
\f3\fs24 ).\
Vamos a los 
\f4\b casos
\f3\b0  \uc0\u55357 \u56391 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 1. Pasar un item a \'93lo est\'e1 preparando\'94 (NEW \uc0\u8594  IN_PROGRESS)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "IN_PROGRESS"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Se usa cuando cocina \'93agarra\'94 el ticket.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 2. Marcar un item como listo (IN_PROGRESS \uc0\u8594  READY)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "READY"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Esto es lo m\'e1s t\'edpico de KDS: \'93ya qued\'f3 este plato\'94.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 3. Servir un item (READY \uc0\u8594  SERVED)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "SERVED"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Se usa m\'e1s en 
\f4\b DINE_IN
\f3\b0  cuando el mesero ya lo llev\'f3 a la mesa.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 4. Cancelar un item (cualquiera \uc0\u8594  CANCELED)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "CANCELED",\
  "reason": "Cliente lo cambi\'f3 por otra cosa"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Aqu\'ed es donde el repo suele:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls48\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 marcar el item en 
\f5\fs26 CANCELED
\f3\fs24 \
\ls48\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 volver a calcular el total de la orden (porque un item menos = total menos)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 5. Cancelar sin motivo\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "CANCELED"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 V\'e1lido: el 
\f5\fs26 reason
\f3\fs24  era opcional.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 6. Volver un item a NEW (p.ej. se equivocaron)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "NEW"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Esto lo usan cuando cocina dijo READY pero se dieron cuenta que no estaba.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 7. Item que es combo padre \uc0\u8594  marcar READY (propaga)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "READY"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Qu\'e9 hace el repo (lo esperado con tu modelo):\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls49\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 pone el 
\f4\b padre
\f3\b0  en READY\
\ls49\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 pone los 
\f4\b childItems
\f3\b0  en READY tambi\'e9n\
\ls49\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 para que en el KDS no te salgan los hijos \'93colgados\'94\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 8. Item que es combo padre \uc0\u8594  cancelar TODO el combo\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "CANCELED",\
  "reason": "El cliente cancel\'f3 el combo"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Lo normal en este dise\'f1o:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls50\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 padre \uc0\u8594  CANCELED\
\ls50\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 hijos \uc0\u8594  CANCELED\
\ls50\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 recalc \uc0\u8594  baja el total\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 9. Item que es combo hijo \uc0\u8594  cancelar SOLO ese hijo\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Si pegas al 
\f5\fs26 itemId
\f3\fs24  del 
\f4\b hijo
\f3\b0 , tambi\'e9n funciona:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "status": "CANCELED",\
  "reason": "Sin papas"\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls51\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 ese hijo queda CANCELED\
\ls51\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 el padre queda como estaba\
\ls51\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 el total se recalcula\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 10. Marcar READY algo que ven\'eda de delivery\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "READY"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Sirve porque en 
\f5\fs26 /api/orders/kds/list
\f3\fs24  mostraste delivery tambi\'e9n.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 11. Intentar SERVED directo desde NEW (no recomendado pero posible)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "SERVED"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Tu API no hace un \'93workflow estricto\'94 aqu\'ed, as\'ed que lo va a aceptar; el front debe decidir si lo permite o no.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 12. Body vac\'edo \uc0\u8594  error de validaci\'f3n\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta esperada:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 400,\
    "details": "status is required"\
  \},\
  "data": null,\
  "message": "Validation failed"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 13. Estado no v\'e1lido \uc0\u8594  error\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "DONE"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 400,\
    "details": "Invalid enum value for status"\
  \},\
  "data": null,\
  "message": "Validation failed"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 14. Item no existe \uc0\u8594  404\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "READY"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u8594  si el 
\f5\fs26 :itemId
\f3\fs24  no existe:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 404,\
    "details": null\
  \},\
  "data": null,\
  "message": "Order item not found"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 15. Cancelar item ya SERVED (cocina se equivoc\'f3) \uc0\u55357 \u56384 \
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "CANCELED",\
  "reason": "Se sirvi\'f3 mal"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 En tu repositorio este tipo de cambio 
\f4\b no
\f3\b0  est\'e1 bloqueado (el bloqueo fuerte estaba en \'93no cerrar si no est\'e1 pagado\'94), as\'ed que lo va a dejar pasar y va a recalcular.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 16. Ready con raz\'f3n (para cocina)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "status": "READY",\
  "reason": "Sin az\'facar, lo pidi\'f3 as\'ed"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Se guarda el status; la raz\'f3n puede ir a log o a nota.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 Resumen r\'e1pido\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls52\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Ruta
\f3\b0 : 
\f5\fs26 PATCH /api/orders/items/:itemId/status
\f3\fs24 \
\ls52\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Campos
\f3\b0 : 
\f5\fs26 \{ "status": "...", "reason"?: "..." \}
\f3\fs24 \
\ls52\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Estados v\'e1lidos
\f3\b0 : 
\f5\fs26 NEW
\f3\fs24 , 
\f5\fs26 IN_PROGRESS
\f3\fs24 , 
\f5\fs26 READY
\f3\fs24 , 
\f5\fs26 SERVED
\f3\fs24 , 
\f5\fs26 CANCELED
\f3\fs24 \
\ls52\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula
\f3\b0 : s\'ed, el pedido completo\
\ls52\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Combos
\f3\b0 : si tocas el padre, toca a los hijos (READY y CANCELED)\
\ls52\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Errores
\f3\b0 : 400 si no manda status, 404 si no existe item\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Con esto ya tienes TODO lo que tu front puede mandar y TODO lo que debe esperar \uc0\u55357 \u56396 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 7.4 Eliminar \'edtem\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 DELETE
\f0\b0  /api/orders/items/:itemId\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls53\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Elimina el \'edtem\
\ls53\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Elimina hijos / modifiers\
\ls53\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f1\b\fs26 Recalcula totales
\f0\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls54\ilvl0
\f3\fs24 \cf0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Lee 
\f5\fs26 :itemId
\f3\fs24  y lo convierte a n\'famero.\
\ls54\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Llama al repo: 
\f6\b\fs26 orderRepository.deleteItem(itemId)
\f3\b0\fs24 .\
\ls54\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 El repo:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls54\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 busca el 
\f4\b item
\f3\b0  (con 
\f5\fs26 parentItemId
\f3\fs24  y 
\f5\fs26 childItems
\f3\fs24 )\
\ls54\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 lo borra\
\ls54\ilvl1
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 si el item era combo padre
\f3\b0  \uc0\u8594  borra 
\f4\b tambi\'e9n
\f3\b0  los hijos\
\ls54\ilvl1
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 si el item era combo hijo
\f3\b0  \uc0\u8594  solo borra ese hijo\
\ls54\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 al final llama a 
\f4\b recalcTotals
\f3\b0  del pedido para que los totales queden bien.\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls54\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Devuelve tu 
\f4\b wrapper
\f3\b0  t\'edpico:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls54\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "error": null,\
\ls54\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "data": \{ "deleted": true, "orderId": 45 \},\
\ls54\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "message": "OK"\
\ls54\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \}\
\ls54\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 \u8232 
\f3\fs24 (algunas veces regresan el pedido completo; pero en tu proyecto de \'f3rdenes casi siempre regresan algo con 
\f5\fs26 data
\f3\fs24  + 
\f5\fs26 message
\f3\fs24 )\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 Casos que S\'cd tienen sentido\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 1. Borrar un \'edtem simple\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
DELETE /api/orders/items/101\
\pard\pardeftab720\sa240\partightenfactor0

\f4\b\fs24 \cf0 Antes
\f3\b0  el pedido ten\'eda:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls55\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 item #101 \uc0\u8594  \'93Torta ahogada\'94 x2 \u8594  13,000\
\ls55\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 totalCents: 13,000\
\pard\pardeftab720\sa240\partightenfactor0

\f4\b \cf0 \strokec2 Despu\'e9s
\f3\b0 :\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": null,\
  "data": \{\
    "deleted": true,\
    "orderId": 45\
  \},\
  "message": "OK"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 y el pedido queda con:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls56\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 items: []\
\ls56\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 totalCents: 0\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 (esto lo hace el 
\f5\fs26 recalcTotalsTx
\f3\fs24 )\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 2. Borrar un \'edtem VARIANTED\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
DELETE /api/orders/items/205\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Ese item ten\'eda:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "id": 205,\
  "productId": 25,\
  "variantId": 4,\
  "quantity": 1\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u8594  se va completo, no tienes que mandar la variante. El repo ya sabe cu\'e1l era.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 3. Borrar un \'edtem con modifiers\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
DELETE /api/orders/items/310\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Aunque ese item ten\'eda 
\f5\fs26 modifiers
\f3\fs24  asociados, el repo los borra en cascada (porque est\'e1n relacionados por 
\f5\fs26 orderItemId
\f3\fs24 ), 
\f4\b y luego
\f3\b0  recalc.\uc0\u8232 Resultado:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": null,\
  "data": \{\
    "deleted": true,\
    "orderId": 61\
  \},\
  "message": "OK"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 4. Borrar un combo padre (borra tambi\'e9n los hijos)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
DELETE /api/orders/items/400\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Supongamos que el pedido ten\'eda:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls57\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 item 
\f4\b 400
\f3\b0  \uc0\u8594  \'93Combo burger + papas\'94 (padre)\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls57\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 child 401 \uc0\u8594  \'93Hamburguesa sencilla\'94\
\ls57\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 child 402 \uc0\u8594  \'93Papas fritas\'94\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Al borrar 
\f4\b 400
\f3\b0  el repo ve que tiene 
\f5\fs26 childItems
\f3\fs24  y:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls58\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 borra 400\
\ls58\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 borra 401\
\ls58\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 borra 402\
\ls58\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 recalcula el pedido\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Respuesta:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": null,\
  "data": \{\
    "deleted": true,\
    "orderId": 90\
  \},\
  "message": "OK"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u55357 \u56393  Esto es importante: 
\f4\b no
\f3\b0  tienes que mandar los IDs de los hijos; el backend ya los conoce porque en tu 
\f5\fs26 getById
\f3\fs24  los inclu\'edas con 
\f5\fs26 childItems: true
\f3\fs24 .\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 5. Borrar solo un hijo del combo\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 S\'ed se puede, si llamas al hijo:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
DELETE /api/orders/items/402\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls59\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 No borra al padre\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Solo borra ese hijo\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula totales (el combo va a bajar el total de extras si ese hijo ten\'eda)\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Te responde igual:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls59\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "error": null,\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "data": \{\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2     "deleted": true,\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2     "orderId": 90\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   \},\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "message": "OK"\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   \}\
\ls59\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 
\f3\fs24 \
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Esto sirve cuando en cocina dijeron \'93el combo sin papas\'94.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 6. Borrar el \'faltimo \'edtem del pedido\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
DELETE /api/orders/items/555\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Si era el \'fanico:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls60\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 el pedido 
\f4\b no
\f3\b0  se borra\
\ls60\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 solo se queda con 
\f5\fs26 items: []
\f3\fs24  y totales en 0\
\ls60\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 as\'ed luego le puedes volver a meter items\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 7. Borrar un \'edtem de un pedido ya en HOLD / OPEN\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Es v\'e1lido, porque el permiso es 
\f5\fs26 orders.update
\f3\fs24  y tu proyecto permite editar mientras no est\'e9 
\f4\b CLOSED
\f3\b0 .\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
DELETE /api/orders/items/777\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 8. Intentar borrar un item que no existe \uc0\u8594  404\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
DELETE /api/orders/items/999999\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta esperada:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 404,\
    "details": null\
  \},\
  "data": null,\
  "message": "Order item not found"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 9. Intentar borrar un \'edtem de un pedido cerrado (si el repo lo protege)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 En tu instrucci\'f3n de \'f3rdenes hab\'eda una regla fuerte para 
\f4\b cerrar
\f3\b0 , no tanto para borrar, pero muchas veces el repo hace:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls61\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 busca el item\
\ls61\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 ve que el pedido est\'e1 
\f5\fs26 CLOSED
\f3\fs24 \
\ls61\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 responde 400\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Entonces:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
DELETE /api/orders/items/880\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta probable:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 400,\
    "details": "Cannot edit items from a closed order"\
  \},\
  "data": null,\
  "message": "Order is closed"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 (esto depende de si en tu repo pusiste el check; lo pongo porque en tu proyecto s\'ed pusiste el check \'93no permitir cerrar si no est\'e1 pagado\'94, o sea s\'ed cuidas integridad)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 10. Borrar un \'edtem con cantidad alta\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 No hace falta decir la cantidad; la cantidad est\'e1 en la fila.\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
DELETE /api/orders/items/620\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u8594  se borra la l\'ednea entera (no \'931 de 5\'94), ese endpoint es de 
\f4\b delete line
\f3\b0 , no de \'93remove 1\'94.\
Si quisieras \'93bajar de 5 a 4\'94, usas:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
PATCH /api/orders/items/:itemId\
\{\
  "quantity": 4\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 11. Borrar un \'edtem que ten\'eda extras caros \uc0\u8594  baja totales\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Esto es justamente por lo que el repo hace 
\f4\b recalc
\f3\b0  despu\'e9s del delete.\uc0\u8232 Ejemplo:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
DELETE /api/orders/items/701\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Ese item ten\'eda:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls62\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 basePriceCents: 8000\
\ls62\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 extrasTotalCents: 3000\
\ls62\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 totalPriceCents: 11000\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Al borrarlo:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls63\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 order.subtotalCents baja 8000\
\ls63\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 order.totalCents baja 11000\
\ls63\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 si los pagos ya eran = total, ahora el pedido quedar\'e1 \'93sobrepagado\'94 \uc0\u8594  ese ajuste suele quedar ya en otro endpoint, pero al menos el order.total ya se corrigi\'f3.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 Resumen para tu front\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls64\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Ruta
\f3\b0 : 
\f5\fs26 DELETE /api/orders/items/:itemId
\f3\fs24 \
\ls64\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Permiso
\f3\b0 : 
\f5\fs26 orders.update
\f3\fs24 \
\ls64\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Qu\'e9 borra
\f3\b0 : 1 l\'ednea. Si es combo padre \uc0\u8594  borra tambi\'e9n hijos.\
\ls64\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Siempre recalcula
\f3\b0 : s\'ed.\
\ls64\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Errores que debes manejar
\f3\b0 :\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls64\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 404 \uc0\u8594  item no existe\
\ls64\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 400 \uc0\u8594  pedido cerrado / no editable\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls64\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 No hay body
\f3\b0 : es un DELETE puro.\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Con esto ya tienes TODOS los casos que tu backend (como lo traes en el zip) puede usar con este endpoint \uc0\u9989 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 8. Pagos\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 POST
\f0\b0  /api/orders/:id/payments\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\uc0\u8232 
\f1\b Body:
\f0\b0  AddPaymentDto\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls65\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Registra 
\f1\b pago + propina
\f0\b0 \
\ls65\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Revisa el 
\f1\b acumulado
\f0\b0 \
\ls65\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Si ya cubre el total \uc0\u8594  
\f1\b cierra autom\'e1ticamente
\f0\b0  el pedido\
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 DTO exacto (de tu zip)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
export const AddPaymentDto = z.object(\{\
  method: z.enum(["CASH", "CARD", "TRANSFER", "OTHER"]),\
  amountCents: z.number().int().nonnegative(),\
  tipCents: z.number().int().nonnegative().default(0),\
  note: z.string().optional()\
\});\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Traducci\'f3n:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls66\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 method
\f3\b0  \uc0\u8594  obligatorio \u8594  
\f5\fs26 CASH | CARD | TRANSFER | OTHER
\f3\fs24 \
\ls66\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 amountCents
\f3\b0  \uc0\u8594  obligatorio \u8594  entero \u8805  0 (en 
\f4\b centavos
\f3\b0 )\
\ls66\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tipCents
\f3\b0  \uc0\u8594  opcional \u8594  entero \u8805  0 (default 0)\
\ls66\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 note
\f3\b0  \uc0\u8594  opcional\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 Qu\'e9 hace el 
\f7\i \strokec2 repo
\f4\i0 \strokec2  (esto es lo chido)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 En 
\f5\fs26 PrismaOrderRepository.addPayment(...)
\f3\fs24  hace:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls67\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Crea el pago:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls67\ilvl1
\f5\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 orderId
\f3\fs24 : el que viene en la ruta\
\ls67\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 method
\f3\fs24 : el que mandaste\
\ls67\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 amountCents
\f3\fs24 \
\ls67\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tipCents
\f3\fs24  (o 0)\
\ls67\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 receivedByUserId
\f3\fs24 : el user que sac\'f3 del token\
\ls67\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 note
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls67\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Luego 
\f4\b agrega todos los pagos de la orden
\f3\b0 :\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 const agg = await tx.payment.aggregate(\{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls67\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   where: \{ orderId \},\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   _sum: \{ amountCents: true, tipCents: true \},\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \});\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 const ord = await tx.order.findUnique(\{ where: \{ id: orderId \} \});\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 const paid = (agg._sum.amountCents || 0) + (agg._sum.tipCents || 0);\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 if (ord && paid >= (ord.totalCents || 0)) \{\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   await tx.order.update(\{\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2     where: \{ id: orderId \},\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2     data: \{ status: "CLOSED", closedAt: new Date() \},\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   \});\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \}\
\ls67\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 \u8232 
\f3\fs24 \uc0\u55357 \u56628  Eso significa: 
\f4\b si con este pago ya alcanzaste o superaste el total, la orden se cierra sola
\f3\b0  (
\f5\fs26 status: "CLOSED"
\f3\fs24 ).\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls67\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Te regresa 
\f4\b el pago
\f3\b0  que cre\'f3.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 Respuesta t\'edpica\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "error": null,\
  "data": \{\
    "id": 25,\
    "orderId": 70,\
    "method": "CASH",\
    "amountCents": 20000,\
    "tipCents": 0,\
    "paidAt": "2025-10-30T18:20:00.000Z",\
    "receivedByUserId": 1,\
    "note": null\
  \},\
  "message": "Paid"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 status HTTP: 
\f4\b 201
\f3\b0 \
Ojo: 
\f4\b NO
\f3\b0  te devuelve la orden; te devuelve 
\f4\b el pago
\f3\b0 . Si el front quiere ver que se cerr\'f3, hace luego 
\f5\fs26 GET /api/orders/:id
\f3\fs24 .\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 TODOS los casos que puedes mandar \uc0\u55357 \u56496 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 1. Pago en efectivo (simple)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 15000\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls68\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tip = 0\
\ls68\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 si el total de la orden \uc0\u8804  150.00 \u8594  la cierra\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 2. Pago con propina\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 15000,\
  "tipCents": 2000\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Aqu\'ed el repo suma 
\f4\b amountCents + tipCents
\f3\b0  para ver si cierra.\uc0\u8232 O sea, si la orden costaba 17,000 \u8594  con esto la cierra.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 3. Pago con tarjeta\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CARD",\
  "amountCents": 23000\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Sirve igual. El m\'e9todo solo se guarda.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 4. Pago por transferencia con nota\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "TRANSFER",\
  "amountCents": 12000,\
  "note": "Transferencia BBVA ref 123"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 5. Pago \'93otro\'94 (vales, etc.)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "OTHER",\
  "amountCents": 5000,\
  "note": "Vale restaurante"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 6. Pago parcial (para luego complementar)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 10000\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls69\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Si el pedido era de 23,000 \uc0\u8594  
\f4\b NO
\f3\b0  la cierra\
\ls69\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 El front puede mostrar: pagado 100.00 / total 230.00\
\ls69\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Luego mandas otro pago (ver caso 7)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 7. Segundo pago que completa la orden\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 1er pago:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 10000\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 2do pago:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "method": "CARD",\
  "amountCents": 13000\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls70\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 El 2do pago hace que 
\f5\fs26 paid >= totalCents
\f3\fs24  \uc0\u8594  el repo 
\f4\b cierra
\f3\b0  la orden.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 8. Pago que supera el total (pago \'93de m\'e1s\'94)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 30000\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Si la orden era 23,000:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls71\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 paid = 30,000\
\ls71\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 30,000 \uc0\u8805  23,000 \u8594  se cierra\
\ls71\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 NO
\f3\b0  hace cambio, solo guarda el pago as\'ed\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 9. Pago solo de propina (amount 0, tip > 0)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Como tu DTO permite 
\f5\fs26 amountCents
\f3\fs24  = 0 y 
\f5\fs26 tipCents
\f3\fs24  \uc0\u8805  0:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 0,\
  "tipCents": 500\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls72\ilvl0
\f3\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Guarda el pago\
\ls72\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Suma 500 al \'93paid\'94\
\ls72\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Si con eso alcanza \uc0\u8594  cierra (raro, pero posible)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 10. Pago en 0 total (para probar validaci\'f3n)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 0\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Lo acepta porque es 
\f5\fs26 nonnegative()
\f3\fs24 .\uc0\u8232 No va a cerrar a menos que la orden sea 0.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 11. Pago con nota larga\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CARD",\
  "amountCents": 8000,\
  "note": "Pag\'f3 con tarjeta f\'edsica, aprobaron en terminal"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 12. Intentar pagar sin method \uc0\u8594  400\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "amountCents": 10000\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 500,\
    "details": \{\}\
  \},\
  "data": null,\
  "message": "Error adding payment"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 (el 500 te lo da porque Zod lanz\'f3 error y tu controller lo est\'e1 mapeando a 500 salvo que sea \'93Id inv\'e1lido\'94; si quieres 400 aqu\'ed, hay que ajustar el controller)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 13. Intentar pagar sin auth \uc0\u8594  401\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Porque el controller hace:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
if (!receivedByUserId) return fail(res, "Unauthorized", 401);\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 401,\
    "details": null\
  \},\
  "data": null,\
  "message": "Unauthorized"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 14. Intentar pagar una orden que NO existe \uc0\u8594  500 (desde repo)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 10000\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 si el 
\f5\fs26 :id
\f3\fs24  no existe, Prisma truena dentro de la tx \uc0\u8594  el controller responde:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 500,\
    "details": \{\}\
  \},\
  "data": null,\
  "message": "Error adding payment"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 (si quieres 404, hay que envolver el create y checar existencia antes)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 15. Pagar una orden que ya estaba CLOSED\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Tu repo 
\f4\b no bloquea
\f3\b0  el create de pago si ya est\'e1 CLOSED: lo que hace es crear el pago y volver a checar.\uc0\u8232 O sea, esto va a funcionar igual:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "method": "CASH",\
  "amountCents": 1000\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 pero la orden seguir\'e1 CLOSED.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 Cosas importantes para tu front\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls73\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Siempre
\f3\b0  manda 
\f5\fs26 method
\f3\fs24  y 
\f5\fs26 amountCents
\f3\fs24 .\
\ls73\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 El 
\f4\b usuario autenticado
\f3\b0  es el que se guarda en 
\f5\fs26 receivedByUserId
\f3\fs24  (no lo mandes t\'fa).\
\ls73\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Despu\'e9s de pagar, si quieres ver que 
\f4\b la orden se cerr\'f3
\f3\b0 , haz:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 GET /api/orders/:id\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls73\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 \u8232 
\f3\fs24 porque el POST te regresa 
\f4\b solo el pago
\f3\b0 .\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls73\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Los montos son 
\f4\b en centavos
\f3\b0 .\
\ls73\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Si quieres \'93pago mixto\'94, solo llamas varias veces a este endpoint.\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 9. Split de pedido\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 POST
\f0\b0  /api/orders/:id/split\uc0\u8232 
\f1\b Permiso:
\f0\b0  orders.update\uc0\u8232 
\f1\b Body:
\f0\b0  SplitOrderByItemsDto\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls74\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f1\b\fs26 Duplica
\f0\b0  los \'edtems seleccionados a 
\f1\b un nuevo pedido
\f0\b0 \
\ls74\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Incluye 
\f1\b combos
\f0\b0 \
\ls74\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 El nuevo pedido 
\f1\b hereda
\f0\b0 :\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls74\ilvl1
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 serviceType\
\ls74\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 tableId\
\ls74\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 covers\
\ls74\ilvl1
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 source\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls74\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Se pueden 
\f1\b sobrescribir
\f0\b0 \
\ls74\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Marca acceptedAt 
\f1\b de inmediato
\f0\b0 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Qu\'e9 hace el controller (exacto)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls75\ilvl0
\f5\b0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 const orderId = ensureNumericId(req.params.id);
\f3\fs24 \
\ls75\ilvl0
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 const dto = SplitOrderByItemsDto.parse(req.body);
\f3\fs24 \
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 saca 
\f5\fs26 servedByUserId
\f3\fs24  de 
\f5\fs26 req.auth.userId
\f3\fs24  \uc0\u8594  si no hay \u8594  
\f4\b 401
\f3\b0 \
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 llama:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 this.splitOrderByItemsUC.exec(orderId, \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls75\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   ...dto,\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   servedByUserId,\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \});\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls75\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 responde:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 \{\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls75\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "error": null,\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	11	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "data": \{\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	12	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2     "newOrderId": 123,\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	13	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2     "code": "A-2025-000123"\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	14	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   \},\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	15	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2   "message": "Order split"\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	16	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \}\
\ls75\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	17	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 \u8232 
\f3\fs24 con 
\f4\b HTTP 201
\f3\b0 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 DTO exacto (de 
\f6\fs39 \strokec2 orders.dto.ts
\f4\fs36 \strokec2 )\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
export const SplitOrderByItemsDto = z.object(\{\
  itemIds: z.array(z.number().int().positive()).min(1),\
  // Puedes sobreescribir metadatos del pedido nuevo (opcionales)\
  serviceType: ServiceTypeEnum.optional(),\
  tableId: z.number().int().positive().nullable().optional(),\
  note: z.string().optional(),\
  covers: z.number().int().positive().optional()\
\});\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Traducci\'f3n:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls76\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 itemIds
\f3\b0  \uc0\u9989  obligatorio, al menos 1\
\ls76\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 serviceType
\f3\b0  \uc0\u10067  opcional \u8594  si no lo mandas, usa el del pedido original\
\ls76\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tableId
\f3\b0  \uc0\u10067  opcional \u8594  puedes poner mesa nueva o 
\f5\fs26 null
\f3\fs24  para que NO tenga\
\ls76\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 note
\f3\b0  \uc0\u10067  opcional \u8594  nota del 
\f4\b nuevo
\f3\b0  pedido\
\ls76\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 covers
\f3\b0  \uc0\u10067  opcional \u8594  comensales del 
\f4\b nuevo
\f3\b0  pedido\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 Lo M\'c1S importante de tu repo (esto es lo que lo hace especial)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 En 
\f5\fs26 PrismaOrderRepository.splitOrderByItems(...)
\f3\fs24  hace 5 pasos:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls77\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Valida
\f3\b0  que todos los 
\f5\fs26 itemIds
\f3\fs24  sean de 
\f4\b ese
\f3\b0  pedido (
\f5\fs26 sourceOrderId
\f3\fs24 ).\uc0\u8232 Si hay uno que no\'85 \u8594  
\f4\b "Todos los items deben pertenecer al mismo pedido"
\f3\b0 \
\ls77\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Expande combos
\f3\b0 :\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls77\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 si mandaste un 
\f4\b padre
\f3\b0  \uc0\u8594  mete 
\f4\b todos sus hijos
\f3\b0 \
\ls77\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 si mandaste un 
\f4\b hijo
\f3\b0  \uc0\u8594  mete su 
\f4\b padre
\f3\b0  y 
\f4\b todos los hermanos
\f3\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls77\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Crea
\f3\b0  el pedido nuevo copiando del original:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls77\ilvl1
\f5\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 status: "OPEN"
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 serviceType: input.serviceType ?? src.serviceType
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 source: src.source ?? "POS"
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tableId: input.tableId ?? src.tableId ?? null
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 note: input.note ?? null
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 covers: input.covers ?? src.covers ?? null
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 servedByUserId: input.servedByUserId
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 acceptedAt: new Date()
\f3\fs24 \
\ls77\ilvl1
\f5\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 code: generateOrderCode()
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls77\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Mueve
\f3\b0  esos items al nuevo pedido (
\f5\fs26 updateMany ... data: \{ orderId: newOrder.id \}
\f3\fs24 )\
\ls77\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Recalcula totales en los dos
\f3\b0  pedidos:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls77\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 el original (porque le quitaste cosas)\
\ls77\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 el nuevo (porque le pusiste cosas)\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 y te regresa:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{ "newOrderId": ..., "code": "..." \}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Listo \uc0\u55357 \u56396 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 CASOS \uc0\u55357 \u56485 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 1. Dividir un pedido de mesa en dos mesas\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Pedido original: 
\f4\b id = 45
\f3\b0 , DINE_IN, mesa 3\uc0\u8232 Quiero pasar 2 platillos a la mesa 7\

\f4\b Request
\f3\b0 \
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "itemIds": [101, 102],\
  "tableId": 7\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f4\b\fs24 \cf0 Qu\'e9 pasa:
\f3\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls78\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 crea NUEVO pedido:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls78\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 status: OPEN\
\ls78\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 serviceType: DINE_IN (copiado)\
\ls78\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tableId: 
\f4\b 7
\f3\b0  (lo que mandaste)\
\ls78\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 note: null\
\ls78\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 covers: los del original\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls78\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 mueve los items 101 y 102 ah\'ed\
\ls78\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 recalcula los dos\
\pard\pardeftab720\sa240\partightenfactor0

\f4\b \cf0 \strokec2 Response
\f3\b0 \
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": null,\
  "data": \{\
    "newOrderId": 120,\
    "code": "A-2025-000120"\
  \},\
  "message": "Order split"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 2. Dividir sin cambiar mesa (solo separar ticket)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Pedido original: mesa 3\uc0\u8232 Solo quiero mandar estos items a \'93otra cuenta\'94 pero 
\f4\b misma mesa
\f3\b0 .\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "itemIds": [101, 103]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 (no mandas mesa)\
\uc0\u8594  el repo hace:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls79\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tableId: 
\f5\fs26 src.tableId
\f3\fs24  (o sea, la misma 3)\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 3. Dividir y quitar mesa (p.ej. para cobrar en caja)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "itemIds": [200, 201],\
  "tableId": null,\
  "note": "Cobro en caja"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u8594  nuevo pedido nace 
\f4\b sin mesa
\f3\b0  y con nota \'93Cobro en caja\'94.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 4. Dividir y cambiar serviceType (de DINE_IN a TAKEAWAY)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Esto es \'fatil cuando alguien de la mesa dice \'93ese es para llevar\'94.\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "itemIds": [300],\
  "serviceType": "TAKEAWAY",\
  "note": "Para llevar"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u8594  nuevo pedido:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls80\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 serviceType = TAKEAWAY\
\ls80\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 tableId = null (porque no mandaste y TAKEAWAY no ocupa)\
\ls80\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 note = \'93Para llevar\'94\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 5. Dividir un combo padre (manda SOLO el padre)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Sup\'f3n que en el pedido hay un combo con itemId 400.\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "itemIds": [400]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 El repo ve que 400 
\f4\b tiene hijos
\f3\b0  \uc0\u8594  busca a todos sus hijos \u8594  los mete tambi\'e9n \u8594  se van JUNTOS al nuevo pedido.\u8232 As\'ed no te queda el combo descuadrado.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 6. Dividir un hijo de combo (manda SOLO el hijo)\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Sup\'f3n que el pap\'e1 es 400 y el hijo que quieres mover es 402.\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "itemIds": [402]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 El repo hace EXACTAMENTE esto:\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls81\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \'93Ah, este es hijo\'94\
\ls81\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 trae a su padre\
\ls81\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 trae a sus hermanos\
\ls81\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 mete a TODOS juntos en el nuevo pedido\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 \strokec2 Resultado: 
\f4\b nunca te quedas con un combo \'93partido\'94
\f3\b0 .\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 7. Dividir y poner covers distintos\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "itemIds": [501, 502],\
  "covers": 1\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u8594  nuevo pedido con 
\f5\fs26 covers = 1
\f3\fs24 \uc0\u8232 \u8594  pedido origen se queda con sus covers originales.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 8. Dividir con nota espec\'edfica (para cocina / caja)\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "itemIds": [601],\
  "note": "Cliente paga por separado"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 9. Intentar dividir sin items \uc0\u8594  ERROR\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "itemIds": []\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 400,\
    "details": "itemIds must contain at least 1 element(s)"\
  \},\
  "data": null,\
  "message": "Error splitting order"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 (esto viene del Zod porque pusiste 
\f5\fs26 .min(1)
\f3\fs24 )\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 10. Intentar dividir items de 2 pedidos diferentes \uc0\u8594  ERROR\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Sup\'f3n que mandas 
\f5\fs26 [101, 9999]
\f3\fs24  y 9999 es de otro pedido.\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "itemIds": [101, 9999]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta (del repo):\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 500,\
    "details": "Todos los items deben pertenecer al mismo pedido"\
  \},\
  "data": null,\
  "message": "Error splitting order"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 11. Intentar dividir con usuario no autenticado \uc0\u8594  401\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 (no tiene 
\f5\fs26 req.auth.userId
\f3\fs24 )\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "itemIds": [101]\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Respuesta:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 401,\
    "details": null\
  \},\
  "data": null,\
  "message": "Unauthorized"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 Porque el controller hace:\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
if (!servedByUserId) return fail(res, "Unauthorized", 401);\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 12. Dividir y mandar serviceType + tableId juntos\
\pard\pardeftab720\partightenfactor0

\f5\b0\fs26 \cf0 \
\{\
  "itemIds": [710, 711],\
  "serviceType": "DINE_IN",\
  "tableId": 12,\
  "note": "Se cambiaron de mesa"\
\}\
\pard\pardeftab720\sa240\partightenfactor0

\f3\fs24 \cf0 \uc0\u8594  v\'e1lido; el nuevo pedido nace como DINE_IN en mesa 12.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f4\b\fs28 \cf0 \strokec2 13. Pedido origen no existe \uc0\u8594  ERROR\
\pard\pardeftab720\sa240\partightenfactor0

\f3\b0\fs24 \cf0 Si el 
\f5\fs26 :id
\f3\fs24  no existe:\

\f4\b Request
\f3\b0 \
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
POST /api/orders/99999/split\
\pard\pardeftab720\sa240\partightenfactor0

\f4\b\fs24 \cf0 Body
\f3\b0 \
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{ "itemIds": [1] \}\
\pard\pardeftab720\sa240\partightenfactor0

\f4\b\fs24 \cf0 Response
\f3\b0  (del repo):\
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf0 \
\{\
  "error": \{\
    "code": 500,\
    "details": "Pedido origen no existe"\
  \},\
  "data": null,\
  "message": "Error splitting order"\
\}\
\pard\pardeftab720\partightenfactor0

\f3\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f4\b\fs36 \cf0 \strokec2 Cosas que tu front TIENE que saber\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls82\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Este endpoint NO regresa el pedido nuevo completo
\f3\b0 , solo:\uc0\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 \{ "newOrderId": ..., "code": "..." \}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls82\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 \u8232 
\f3\fs24 \uc0\u8594  si lo quieres completo haces luego:\u8232 
\f5\fs26 \uc0\u8232 \u8232 \u8232 GET /api/orders/\{\{newOrderId\}\}\
\ls82\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u8232 \u8232 
\f3\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls82\ilvl0
\f4\b \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Siempre recalcula los dos pedidos
\f3\b0 . O sea: en la pantalla de la mesa original te va a bajar el total.\
\ls82\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Nunca te deja combos \'93rotos\'94
\f3\b0 : si mandas pap\'e1 o hijo, mueve el combo entero (padre + hijos + hermanos).\
\ls82\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Puedes usarlo para \'93pagar por separado\'94
\f3\b0 : divides, pagas el nuevo, dejas el viejo abierto.\
\ls82\ilvl0
\f4\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Se guarda qui\'e9n hizo el split
\f3\b0  (
\f5\fs26 servedByUserId
\f3\fs24 ), lo cual est\'e1 chido para auditor\'eda.\
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 10. Notas funcionales clave\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls83\ilvl0
\f2\b0\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 Los 
\f1\b totales
\f0\b0  siempre se recalculan ignorando \'edtems cancelados.\
\ls83\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Se respetan 
\f1\b descuentos / impuestos / service fee
\f0\b0  ya guardados.\
\ls83\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 prepEtaMinutes sirve para mostrar ETA en front / kiosko.\
\ls83\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 source y externalRef diferencian 
\f1\b interno vs plataforma
\f0\b0 .\
\ls83\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 Con esto el front puede hacer todo el flujo:\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls83\ilvl1\cf0 {\listtext	0.	}creaci\'f3n\
{\listtext	0.	}agregar / editar \'edtems\
{\listtext	0.	}KDS\
{\listtext	0.	}cobros\
{\listtext	0.	}cierre\
{\listtext	0.	}listado con filtros\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
\pard\pardeftab560\sa40\partightenfactor0

\f1\b\fs32 \cf0 11. Glosario para el front\
\pard\pardeftab560\slleading20\partightenfactor0

\fs26 \cf0 Permisos
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls84\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 orders.read: puede listar y ver\
\ls84\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 orders.create: puede crear\
\ls84\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 orders.update: puede editar, pagar, mover estado\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 serviceType
\f0\b0  (tipo de servicio)\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls85\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 DINE_IN: consumo en mesa\
\ls85\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 TAKEAWAY: para llevar\
\ls85\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 DELIVERY: a domicilio\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 source
\f0\b0  (canal)\
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls86\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 POS: pedido directo\
\ls86\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 UBER, DIDI, RAPPI: plataformas externas\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 status del pedido
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls87\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 DRAFT: borrador, no cocina\
\ls87\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 OPEN: activo\
\ls87\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 HOLD: en pausa\
\ls87\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 CLOSED: cobrado y cerrado\
\ls87\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 CANCELED: cancelado\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 OrderItem.status
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls88\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 NEW\
\ls88\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 IN_PROGRESS\
\ls88\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 READY\
\ls88\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 SERVED\
\ls88\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 CANCELED\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Timestamps
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls89\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 acceptedAt: el pedido sali\'f3 de borrador / cocina lo tom\'f3\
\ls89\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 readyAt: todos los \'edtems est\'e1n listos\
\ls89\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 servedAt: todos servidos o cancelados\
\ls89\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 closedAt: se cobr\'f3\
\ls89\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 canceledAt: se cancel\'f3\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Totales (centavos)
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls90\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 subtotalCents: suma de renglones\
\ls90\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 discountCents: descuentos\
\ls90\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 serviceFeeCents: propina/fee fijo\
\ls90\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 taxCents: impuestos\
\ls90\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 totalCents: subtotal - descuento + service + tax\
\ls90\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 paymentsTotalCents: suma de pagos\
\ls90\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 paymentsTipCents: suma de propinas\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Pagos (payments[])
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls91\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 method: CASH | CARD | TRANSFER | OTHER\
\ls91\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 amountCents\
\ls91\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 tipCents\
\ls91\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 paidAt\
\ls91\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 note\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 Mesa
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls92\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 tableId: id de la mesa\
\ls92\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 table: \{ id, name \} para mostrar \'93Mesa 12\'94\
\ls92\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 covers: n\'famero de comensales\
\pard\pardeftab560\slleading20\partightenfactor0

\f1\b \cf0 DTOs clave
\f0\b0 \
\pard\pardeftab560\pardirnatural\partightenfactor0
\ls93\ilvl0
\f2\fs18 \cf0 {\listtext	\uc0\u8226 	}
\f0\fs26 ListOrdersQueryDto: filtros del GET\
\ls93\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 UpdateOrderMetaDto: para editar nota, mesa, cubiertos, ETA\
\ls93\ilvl0
\f2\fs18 {\listtext	\uc0\u8226 	}
\f0\fs26 UpdateOrderStatusDto: para mover el pedido validando pagos\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \
Si quieres, en la siguiente te lo bajo todav\'eda m\'e1s a \'93doc para front\'94 (solo campos + ejemplo), pero as\'ed ya est\'e1 ordenado y sin que se vea todo pegado.\
}